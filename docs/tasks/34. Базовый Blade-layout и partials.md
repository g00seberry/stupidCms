# Задача 34. Базовый Blade-layout и partials

## Резюме
Создать единый базовый Blade‑layout `layouts/app.blade.php` и два partial‑шаблона `partials/header.blade.php` и `partials/footer.blade.php`. Все публичные страницы/шаблоны наследуются от базового layout. Partials подключаются **без передачи данных** (используют глобальные хелперы/конфиг/вью-композеры).

**Критерии приёмки:**
- Страницы наследуют `layouts/app` через `@extends`.
- `header` и `footer` подключаются через `@include` без параметров.

Связанные: 31 (PageController), 32 (HomeController), 33 (TemplateResolver), 45 (ResponseCache), 58 (Admin UI: настройки бренда/навигации).

---

## Структура файлов
```
resources/views/
 ├─ layouts/
 │   └─ app.blade.php
 ├─ partials/
 │   ├─ header.blade.php
 │   └─ footer.blade.php
 └─ pages/
     └─ show.blade.php         # пример, уже существует (Задача 31)
```

---

## Layout: `resources/views/layouts/app.blade.php`
```blade
<!DOCTYPE html>
<html lang="{{ app()->getLocale() }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>@yield('title', config('app.name'))</title>
  @yield('meta')
  @stack('head')
  @vite(['resources/css/app.css','resources/js/app.js'])
</head>
<body class="min-h-screen flex flex-col">
  @include('partials.header')

  <main id="content" class="grow">
    @yield('content')
  </main>

  @include('partials.footer')

  @stack('scripts')
</body>
</html>
```

### Пояснения
- `@yield('title')` и `@yield('meta')` — секции для страниц.
- `@stack('head')`/`@stack('scripts')` — стек для точечных вставок.
- `@vite(...)` — подключение ассетов (Laravel 12, Vite по умолчанию).
- Partials подключены **без параметров**: обязуемся не требовать данных.

---

## Partials
### `resources/views/partials/header.blade.php`
```blade
<header data-partial="header" class="border-b">
  <div class="container mx-auto px-4 py-4 flex items-center justify-between">
    <a href="{{ url('/') }}" class="font-semibold text-lg">{{ config('app.name') }}</a>
    {{-- Простая навигация; можно расширить позже через меню/опции */}
    <nav class="flex gap-4">
      <a href="/about">About</a>
    </nav>
  </div>
</header>
```

### `resources/views/partials/footer.blade.php`
```blade
<footer data-partial="footer" class="border-t mt-12">
  <div class="container mx-auto px-4 py-6 text-sm text-gray-500">
    © {{ now()->year }} {{ config('app.name') }}
  </div>
</footer>
```

> Оба partial‑шаблона не используют локальные переменные, берут всё из `config()`/`url()`/`now()`/`app()`.

---

## Пример страницы, наследующей layout
`resources/views/pages/show.blade.php`
```blade
@extends('layouts.app')

@section('title', $entry->title)

@section('content')
  <article class="container mx-auto px-4 prose">
    <h1>{{ $entry->title }}</h1>
    {!! $entry->body_html !!}
  </article>
@endsection
```

---

## View Composer (опционально)
Если понадобится передавать глобальные данные (например, меню/настройки бренда) и при этом **не нарушить** требование «partials без данных», используем view‑composer:
```php
// App\Providers\ViewServiceProvider
View::composer(['partials.header','partials.footer'], function ($view) {
    $view->with('siteName', config('app.name'));
});
```

Но в рамках задачи 34 это **не обязательно**.

---

## Тесты (Feature)
1. **Layout наследуется**: запрос к странице (например, `/about`) возвращает HTML, содержащий маркеры `data-partial="header"` и `data-partial="footer"` (проверяем наличие partials).
2. **Без параметров**: рендер `view('partials.header')` и `view('partials.footer')` не падает без данных.

Пример:
```php
$response = $this->get('/about');
$response->assertOk()->assertSee('data-partial="header"', false)->assertSee('data-partial="footer"', false);

$this->view('partials.header')->assertSee(config('app.name'));
$this->view('partials.footer')->assertSee((string) now()->year);
```

---

## Приёмка (Definition of Done)
- [ ] Создан layout `layouts/app.blade.php` с секциями `title`, `meta`, `content`, стеками `head`, `scripts`.
- [ ] Созданы partials `header`, `footer` и подключены **без данных**.
- [ ] Страницы (например, `pages/show`) наследуют layout.
- [ ] Тесты зелёные.

---

## Нефункциональные
- Семантичная разметка (header/main/footer).
- Готовность к CDN/кешу (минимум внешних зависимостей).
- Совместимость с Tailwind (классы условны).