# Quality Gates

Правила контроля качества кода и документации перед завершением задачи.

## Обязательные шаги в конце каждой задачи

После завершения реализации **ОБЯЗАТЕЛЬНО** выполнить следующие шаги:

### 1. Запуск всех тестов

```bash
php artisan test
```

**Требования:**

-   Все тесты должны проходить успешно
-   Если есть падающие тесты — исправить перед завершением задачи
-   Не завершать задачу с красными тестами

### 2. Генерация документации

```bash
composer docs:gen
```

**Что обновляется:**

-   ERD (схема БД) — `docs/_generated/erd.svg`
-   Routes (маршруты) — `docs/_generated/routes.md`
-   Permissions (права доступа) — `docs/_generated/permissions.md`
-   API docs (Scribe) — `docs/_generated/api-docs/`
-   Search mappings — `docs/_generated/search-mappings.md`

**Когда обязательно:**

-   Изменения в API endpoints
-   Изменения в миграциях БД
-   Изменения в Policies
-   Изменения в Routes
-   Любые изменения, влияющие на автогенерируемые артефакты

## Правило

**Никогда не завершать задачу без:**

1. ✅ Успешного прохождения всех тестов
2. ✅ Генерации актуальной документации

## Исключения

Единственное исключение — если задача была отменена или не завершена. В этом случае явно указать статус задачи.

## Чеклист перед завершением

-   [ ] Все тесты проходят (`php artisan test`)
-   [ ] Документация сгенерирована (`composer docs:gen`)
-   [ ] Нет ошибок линтера (PHPStan, если настроен)
-   [ ] Код соответствует стандартам проекта (PSR-12, strict_types)
-   [ ] Обновлены релевантные артефакты (ERD/Routes/Permissions)
