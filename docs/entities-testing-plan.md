# –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π –ø—Ä–æ–µ–∫—Ç–∞ stupidCMS

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-17  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** üìã –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

---

## –û–±–∑–æ—Ä

–î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—é —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π –ø—Ä–æ–µ–∫—Ç–∞ stupidCMS.  
–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç **170 —Å—É—â–Ω–æ—Å—Ç–µ–π**: 16 –º–æ–¥–µ–ª–µ–π, 63 –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞, 60 HTTP —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤, –∏ –¥—Ä.

### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–ü–æ–ª–Ω–æ—Ç–∞:** –ö–∞–∂–¥–∞—è —Å—É—â–Ω–æ—Å—Ç—å –∏–º–µ–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã
2. **–ò–∑–æ–ª—è—Ü–∏—è:** Unit-—Ç–µ—Å—Ç—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –æ—Ç –ë–î –∏ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å:** Feature-—Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
4. **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å:** –¢–µ—Å—Ç—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã –ø–æ –¥–æ–º–µ–Ω–Ω—ã–º –º–æ–¥—É–ª—è–º
5. **–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è:** –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ç–µ—Å—Ç–∏—Ä—É—é—Ç—Å—è –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–ª–∞–Ω–∞

```
1. Models (16 —Å—É—â–Ω–æ—Å—Ç–µ–π)
   ‚îú‚îÄ‚îÄ Unit-—Ç–µ—Å—Ç—ã (scopes, accessors, mutators, relations)
   ‚îî‚îÄ‚îÄ Feature-—Ç–µ—Å—Ç—ã (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ë–î)

2. Domain Services (63 —Å—É—â–Ω–æ—Å—Ç–∏)
   ‚îú‚îÄ‚îÄ Actions (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏)
   ‚îú‚îÄ‚îÄ Services (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤)
   ‚îú‚îÄ‚îÄ Repositories (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤)
   ‚îú‚îÄ‚îÄ Validators (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏)
   ‚îî‚îÄ‚îÄ Value Objects/DTOs

3. HTTP Controllers (60 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤)
   ‚îú‚îÄ‚îÄ Admin API (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, CRUD)
   ‚îî‚îÄ‚îÄ Public API (–ø—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)

4. Validation Rules (6 –ø—Ä–∞–≤–∏–ª)
   ‚îî‚îÄ‚îÄ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª

5. Events & Listeners (9 —Å–æ–±—ã—Ç–∏–π, 3 —Å–ª—É—à–∞—Ç–µ–ª—è)
   ‚îî‚îÄ‚îÄ Feature-—Ç–µ—Å—Ç—ã —Å–æ–±—ã—Ç–∏–π

6. Jobs (2 —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏)
   ‚îî‚îÄ‚îÄ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è jobs

7. Integration Tests
   ‚îî‚îÄ‚îÄ –ü–æ–ª–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```

---

## 1. Models (16 –º–æ–¥–µ–ª–µ–π)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥ –í—ã—Å–æ–∫–∏–π

–ú–æ–¥–µ–ª–∏ ‚Äî –æ—Å–Ω–æ–≤–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ç—Ä–µ–±—É—é—Ç –ø–æ–ª–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è.

#### 1.1. User ‚úÖ

**–ü—É—Ç—å:** `app/Models/User.php`  
**Factory:** `database/factories/UserFactory.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/UserTest.php`) ‚úÖ

```php
‚úÖ test('has fillable attributes')
‚úÖ test('guarded is_admin attribute')
‚úÖ test('has notifications relationship')
‚úÖ test('has entries relationship')
‚úÖ test('has refresh tokens relationship')
‚úÖ test('can check if user is admin')
‚úÖ test('can check if user is regular user')
‚úÖ test('password is cast to hashed')
‚úÖ test('is_admin is cast to boolean')
‚úÖ test('admin_permissions is cast to array')
‚úÖ test('email_verified_at is cast to datetime')
‚úÖ test('returns normalized admin permissions')
‚úÖ test('returns empty array when admin_permissions is null')
‚úÖ test('admin always has any permission')
‚úÖ test('regular user has permission if it is in the list')
‚úÖ test('can grant admin permissions')
‚úÖ test('grant admin permissions does not create duplicates')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/UserTest.php`) ‚úÖ

```php
‚úÖ test('user can be created with factory')
‚úÖ test('admin user can be created')
‚úÖ test('user can have multiple entries')
‚úÖ test('user can have multiple refresh tokens')
‚úÖ test('user password is hashed')
‚úÖ test('user email is unique')
‚úÖ test('user can have admin permissions')
‚úÖ test('user admin_permissions defaults to empty array')
‚úÖ test('user password and remember_token are hidden from serialization')
‚úÖ test('user email_verified_at is stored as datetime')
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª–∏:**

-   –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã `entries()` –∏ `refreshTokens()` –¥–ª—è —Å–≤—è–∑–µ–π
-   –û–±–Ω–æ–≤–ª—ë–Ω PHPDoc —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Å–≤—è–∑–µ–π

---

#### 1.2. Entry ‚úÖ

**–ü—É—Ç—å:** `app/Models/Entry.php`  
**Factory:** `database/factories/EntryFactory.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/EntryTest.php`) ‚úÖ

```php
‚úÖ test('casts data_json to array')
‚úÖ test('casts seo_json to array')
‚úÖ test('casts published_at to datetime')
‚úÖ test('has post type relationship')
‚úÖ test('has author relationship')
‚úÖ test('has terms many to many relationship')
‚úÖ test('has published scope')
‚úÖ test('has of type scope')
‚úÖ test('uses soft deletes')
‚úÖ test('has draft status constant')
‚úÖ test('has published status constant')
‚úÖ test('get statuses returns all statuses')
‚úÖ test('url method returns flat url for page type')
‚úÖ test('url method returns hierarchical url for non-page type')
‚úÖ test('has no guarded attributes')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/EntryTest.php`) ‚úÖ

```php
‚úÖ test('entry can be created with factory')
‚úÖ test('entry belongs to post type')
‚úÖ test('entry belongs to author')
‚úÖ test('entry can have multiple terms')
‚úÖ test('entry can be published')
‚úÖ test('entry can be draft')
‚úÖ test('entry can be soft deleted')
‚úÖ test('entry can be restored')
‚è≠Ô∏è test('entry slug is unique per post type') - skipped (requires real DB)
‚úÖ test('entry slug can be same for different post types')
‚úÖ test('entry published at can be in future')
‚úÖ test('entry data json stores custom fields')
‚úÖ test('entry seo json stores metadata')
‚úÖ test('published scope returns only published entries')
‚úÖ test('of type scope filters by post type slug')
‚úÖ test('entry url is generated correctly for page type')
‚úÖ test('entry url is generated correctly for non-page type')
‚úÖ test('entry template override can be set')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   –¢–µ—Å—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ slug –ø—Ä–æ–ø—É—â–µ–Ω, —Ç–∞–∫ –∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–π –ë–î —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ (–Ω–µ :memory:)
-   –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–¥–µ–ª–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

#### 1.3. Media

**–ü—É—Ç—å:** `app/Models/Media.php`  
**Factory:** `database/factories/MediaFactory.php`

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/MediaTest.php`)

```php
- test('uses ULID as primary key')
- test('casts exif_json to array')
- test('casts deleted_at to datetime')
- test('casts dimensions to integers')
- test('has variants relationship')
- test('has metadata relationship')
- test('has image scope')
- test('has video scope')
- test('has audio scope')
- test('has document scope')
- test('uses soft deletes')
- test('has full url accessor')
- test('has thumbnail accessor')
- test('has is image accessor')
- test('has is video accessor')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/MediaTest.php`)

```php
- test('media can be created with factory')
- test('media has unique disk and path combination')
- test('media can have multiple variants')
- test('media can have metadata')
- test('media can be soft deleted')
- test('media exif json stores metadata')
- test('media dimensions are stored correctly')
- test('media file size is stored in bytes')
```

---

#### 1.4. MediaVariant

**–ü—É—Ç—å:** `app/Models/MediaVariant.php`  
**Factory:** `database/factories/MediaVariantFactory.php`

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/MediaVariantTest.php`)

```php
- test('uses ULID as primary key')
- test('casts status to MediaVariantStatus enum')
- test('casts timestamps to immutable datetime')
- test('belongs to media')
- test('has pending scope')
- test('has processing scope')
- test('has completed scope')
- test('has failed scope')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/MediaVariantTest.php`)

```php
- test('variant belongs to media')
- test('variant status transitions correctly')
- test('variant can be marked as processing')
- test('variant can be marked as completed')
- test('variant can be marked as failed')
```

---

#### 1.5. MediaMetadata

**–ü—É—Ç—å:** `app/Models/MediaMetadata.php`  
**Factory:** `database/factories/MediaMetadataFactory.php`

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/MediaMetadataTest.php`)

```php
- test('casts duration_ms to integer')
- test('casts bitrate_kbps to integer')
- test('casts frame_rate to float')
- test('casts frame_count to integer')
- test('belongs to media')
- test('has duration accessor in seconds')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/MediaMetadataTest.php`)

```php
- test('metadata belongs to media')
- test('metadata stores av technical details')
- test('metadata can store video codec')
- test('metadata can store audio codec')
```

---

#### 1.6. PostType

**–ü—É—Ç—å:** `app/Models/PostType.php`  
**Factory:** `database/factories/PostTypeFactory.php`

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/PostTypeTest.php`)

```php
- test('has fillable attributes')
- test('casts options_json to PostTypeOptions')
- test('has entries relationship')
- test('slug is unique')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/PostTypeTest.php`)

```php
- test('post type can be created')
- test('post type has unique slug')
- test('post type can have multiple entries')
- test('post type options are stored correctly')
```

---

#### 1.7. Plugin

**–ü—É—Ç—å:** `app/Models/Plugin.php`  
**Factory:** `database/factories/PluginFactory.php`

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/PluginTest.php`)

```php
- test('uses ULID as primary key')
- test('casts enabled to boolean')
- test('casts meta_json to array')
- test('casts last_synced_at to immutable datetime')
- test('has enabled scope')
- test('has disabled scope')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/PluginTest.php`)

```php
- test('plugin can be created')
- test('plugin can be enabled')
- test('plugin can be disabled')
- test('plugin stores metadata')
- test('plugin tracks last sync time')
```

---

#### 1.8. Option

**–ü—É—Ç—å:** `app/Models/Option.php`  
**Factory:** `database/factories/OptionFactory.php`

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/OptionTest.php`)

```php
- test('uses ULID as primary key')
- test('has fillable attributes')
- test('casts value_json using AsJsonValue')
- test('has namespace scope')
- test('has key scope')
- test('uses soft deletes')
```

##### Feature-—Çes—Ç—ã (`tests/Feature/Models/OptionTest.php`)

```php
- test('option can be created')
- test('option value is stored as json')
- test('option can be retrieved by namespace and key')
- test('option can be soft deleted')
```

---

#### 1.9. Taxonomy

**–ü—É—Ç—å:** `app/Models/Taxonomy.php`  
**Factory:** `database/factories/TaxonomyFactory.php`

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/TaxonomyTest.php`)

```php
- test('casts options_json to array')
- test('casts hierarchical to boolean')
- test('has terms relationship')
- test('has hierarchical scope')
- test('has flat scope')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/TaxonomyTest.php`)

```php
- test('taxonomy can be created')
- test('taxonomy can be hierarchical')
- test('taxonomy can be flat')
- test('taxonomy can have multiple terms')
```

---

#### 1.10. Term

**–ü—É—Ç—å:** `app/Models/Term.php`  
**Factory:** `database/factories/TermFactory.php`

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/TermTest.php`)

```php
- test('casts meta_json to array')
- test('belongs to taxonomy')
- test('has entries many to many relationship')
- test('has ancestors relationship')
- test('has descendants relationship')
- test('has parent relationship')
- test('has children relationship')
- test('uses soft deletes')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/TermTest.php`)

```php
- test('term belongs to taxonomy')
- test('term can have parent')
- test('term can have children')
- test('term can have multiple ancestors')
- test('term can have multiple descendants')
- test('term can be attached to entries')
- test('term hierarchy is maintained via closure table')
```

---

#### 1.11. TermTree

**–ü—É—Ç—å:** `app/Models/TermTree.php`

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/TermTreeTest.php`)

```php
- test('implements closure table pattern')
- test('stores term relationships')
```

---

#### 1.12. RefreshToken

**–ü—É—Ç—å:** `app/Models/RefreshToken.php`

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/RefreshTokenTest.php`)

```php
- test('has fillable attributes')
- test('casts timestamps to datetime')
- test('belongs to user')
- test('tracks parent token via parent_jti')
- test('can be marked as used')
- test('can be marked as revoked')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/RefreshTokenTest.php`)

```php
- test('refresh token can be created')
- test('refresh token belongs to user')
- test('refresh token can be used once')
- test('refresh token can be revoked')
- test('refresh token supports rotation')
```

---

#### 1.13. ReservedRoute

**–ü—É—Ç—å:** `app/Models/ReservedRoute.php`

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/ReservedRouteTest.php`)

```php
- test('has fillable attributes')
- test('supports path type')
- test('supports prefix type')
- test('has path scope')
- test('has prefix scope')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/ReservedRouteTest.php`)

```php
- test('reserved route can be created')
- test('path type matches exact path')
- test('prefix type matches path prefix')
```

---

#### 1.14. Redirect

**–ü—É—Ç—å:** `app/Models/Redirect.php`

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/RedirectTest.php`)

```php
- test('stores redirect rules')
- test('supports different http status codes')
```

---

#### 1.15. Audit

**–ü—É—Ç—å:** `app/Models/Audit.php`

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/AuditTest.php`)

```php
- test('casts diff_json to array')
- test('casts meta to array')
- test('belongs to user')
- test('tracks entity changes')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/AuditTest.php`)

```php
- test('audit records are created on entity changes')
- test('audit stores diff of changes')
- test('audit belongs to user who made change')
```

---

#### 1.16. Outbox

**–ü—É—Ç—å:** `app/Models/Outbox.php`

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/OutboxTest.php`)

```php
- test('casts payload_json to array')
- test('casts attempts to integer')
- test('casts available_at to datetime')
- test('supports retry attempts')
```

---

## 2. Domain Services (63 —Å—É—â–Ω–æ—Å—Ç–∏)

### 2.1. –ú–æ–¥—É–ª—å Auth (4 —Å—É—â–Ω–æ—Å—Ç–∏)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π

##### 2.1.1. JwtService

**–ü—É—Ç—å:** `app/Domain/Auth/JwtService.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Auth/JwtServiceTest.php`)

```php
- test('generates access token with correct claims')
- test('generates refresh token with correct claims')
- test('validates access token successfully')
- test('validates refresh token successfully')
- test('rejects expired token')
- test('rejects token with invalid signature')
- test('extracts user id from token')
- test('extracts jti from token')
- test('token includes correct expiration time')
```

---

##### 2.1.2. RefreshTokenRepository

**–ü—É—Ç—å:** `app/Domain/Auth/RefreshTokenRepository.php`  
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `app/Domain/Auth/RefreshTokenRepositoryImpl.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Auth/RefreshTokenRepositoryTest.php`)

```php
- test('creates refresh token')
- test('finds refresh token by jti')
- test('marks token as used')
- test('marks token as revoked')
- test('revokes all tokens for user')
- test('checks if token is valid')
- test('checks if token is used')
- test('checks if token is revoked')
- test('checks if token is expired')
- test('supports token rotation')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Auth/RefreshTokenFlowTest.php`)

```php
- test('refresh token flow works end to end')
- test('token rotation creates new token')
- test('old token is marked as used after rotation')
- test('revoked token cannot be used')
- test('expired token cannot be used')
```

---

##### 2.1.3. RefreshTokenDto

**–ü—É—Ç—å:** `app/Domain/Auth/RefreshTokenDto.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Auth/RefreshTokenDtoTest.php`)

```php
- test('creates dto with all properties')
- test('validates required properties')
- test('converts to array')
```

---

##### 2.1.4. JwtAuthenticationException

**–ü—É—Ç—å:** `app/Domain/Auth/Exceptions/JwtAuthenticationException.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Auth/Exceptions/JwtAuthenticationExceptionTest.php`)

```php
- test('exception has correct message')
- test('exception can be thrown and caught')
```

---

### 2.2. –ú–æ–¥—É–ª—å Media (34 —Å—É—â–Ω–æ—Å—Ç–∏)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π

##### 2.2.1. MediaStoreAction

**–ü—É—Ç—å:** `app/Domain/Media/Actions/MediaStoreAction.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Actions/MediaStoreActionTest.php`)

```php
- test('validates uploaded file')
- test('extracts metadata from file')
- test('stores file to disk')
- test('saves media record to database')
- test('dispatches media uploaded event')
- test('returns media model')
- test('handles validation errors')
- test('handles storage errors')
- test('supports different collections')
- test('applies collection specific rules')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Media/MediaUploadFlowTest.php`)

```php
- test('complete media upload flow')
- test('image file is uploaded and stored')
- test('video file is uploaded and metadata extracted')
- test('pdf file is uploaded and validated')
- test('corrupted file is rejected')
- test('oversized file is rejected')
- test('invalid mime type is rejected')
- test('exif data is preserved')
- test('variants are generated after upload')
```

---

##### 2.2.2. ListMediaAction

**–ü—É—Ç—å:** `app/Domain/Media/Actions/ListMediaAction.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Actions/ListMediaActionTest.php`)

```php
- test('lists media with pagination')
- test('filters by mime type')
- test('filters by collection')
- test('includes trashed when requested')
- test('applies search query')
- test('orders by created at')
```

---

##### 2.2.3. UpdateMediaMetadataAction

**–ü—É—Ç—å:** `app/Domain/Media/Actions/UpdateMediaMetadataAction.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Actions/UpdateMediaMetadataActionTest.php`)

```php
- test('updates media title')
- test('updates media alt text')
- test('updates media caption')
- test('validates input data')
- test('returns updated media')
```

---

##### 2.2.4. ExifManager

**–ü—É—Ç—å:** `app/Domain/Media/Services/ExifManager.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Services/ExifManagerTest.php`)

```php
- test('extracts exif data from image')
- test('auto rotates image based on exif orientation')
- test('strips exif data from image')
- test('filters exif fields by whitelist')
- test('extracts color profile from image')
- test('handles images without exif')
```

---

##### 2.2.5. MediaValidationPipeline

**–ü—É—Ç—å:** `app/Domain/Media/Validation/MediaValidationPipeline.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Validation/MediaValidationPipelineTest.php`)

```php
- test('runs all validators')
- test('passes valid file')
- test('rejects invalid file')
- test('stops on first error')
- test('collects all errors')
```

---

##### 2.2.6. CorruptionValidator

**–ü—É—Ç—å:** `app/Domain/Media/Validation/CorruptionValidator.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Validation/CorruptionValidatorTest.php`)

```php
- test('validates image file integrity')
- test('validates video file integrity')
- test('rejects corrupted image')
- test('rejects corrupted video')
- test('supports jpg, png, gif formats')
```

---

##### 2.2.7. MimeSignatureValidator

**–ü—É—Ç—å:** `app/Domain/Media/Validation/MimeSignatureValidator.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Validation/MimeSignatureValidatorTest.php`)

```php
- test('validates file signature matches extension')
- test('rejects file with mismatched signature')
- test('detects fake file extensions')
```

---

##### 2.2.8. SizeLimitValidator

**–ü—É—Ç—å:** `app/Domain/Media/Validation/SizeLimitValidator.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Media/Validation/SizeLimitValidatorTest.php`)

```php
- test('validates file size within limit')
- test('rejects file exceeding size limit')
- test('applies collection specific size limit')
```

---

##### 2.2.9. GdImageProcessor

**–ü—É—Ç—å:** `app/Domain/Media/Images/GdImageProcessor.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Images/GdImageProcessorTest.php`)

```php
- test('opens image file')
- test('gets image width')
- test('gets image height')
- test('resizes image')
- test('encodes image to format')
- test('supports jpg, png, gif, webp')
- test('maintains aspect ratio on resize')
```

---

##### 2.2.10. GlideImageProcessor

**–ü—É—Ç—å:** `app/Domain/Media/Images/GlideImageProcessor.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Images/GlideImageProcessorTest.php`)

```php
- test('opens image with glide')
- test('resizes image with glide')
- test('applies filters')
- test('generates thumbnails')
- test('supports more formats than GD')
```

---

##### 2.2.11. MediaMetadataExtractor

**–ü—É—Ç—å:** `app/Domain/Media/Services/MediaMetadataExtractor.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Media/Services/MediaMetadataExtractorTest.php`)

```php
- test('extracts metadata using available plugins')
- test('tries plugins in order')
- test('returns null if no plugin supports file')
- test('handles plugin errors gracefully')
```

---

##### 2.2.12. ExiftoolMediaMetadataPlugin

**–ü—É—Ç—å:** `app/Domain/Media/Services/ExiftoolMediaMetadataPlugin.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Services/ExiftoolMediaMetadataPluginTest.php`)

```php
- test('supports images')
- test('extracts metadata using exiftool')
- test('parses exiftool json output')
- test('handles exiftool errors')
- test('requires exiftool binary')
```

---

##### 2.2.13. FfprobeMediaMetadataPlugin

**–ü—É—Ç—å:** `app/Domain/Media/Services/FfprobeMediaMetadataPlugin.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Services/FfprobeMediaMetadataPluginTest.php`)

```php
- test('supports video and audio')
- test('extracts duration from video')
- test('extracts bitrate from video')
- test('extracts frame rate from video')
- test('extracts codec information')
- test('requires ffprobe binary')
```

---

##### 2.2.14. MediainfoMediaMetadataPlugin

**–ü—É—Ç—å:** `app/Domain/Media/Services/MediainfoMediaMetadataPlugin.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Services/MediainfoMediaMetadataPluginTest.php`)

```php
- test('supports video and audio')
- test('extracts detailed av metadata')
- test('requires mediainfo binary')
```

---

##### 2.2.15. StorageResolver

**–ü—É—Ç—å:** `app/Domain/Media/Services/StorageResolver.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Media/Services/StorageResolverTest.php`)

```php
- test('resolves storage disk by collection')
- test('returns default disk for unknown collection')
- test('supports s3, local, public disks')
```

---

##### 2.2.16. CollectionRulesResolver

**–ü—É—Ç—å:** `app/Domain/Media/Services/CollectionRulesResolver.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Services/CollectionRulesResolverTest.php`)

```php
- test('gets rules for collection')
- test('returns global rules if collection not configured')
- test('gets allowed mimes for collection')
- test('gets max size for collection')
```

---

##### 2.2.17. OnDemandVariantService

**–ü—É—Ç—å:** `app/Domain/Media/Services/OnDemandVariantService.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Services/OnDemandVariantServiceTest.php`)

```php
- test('generates variant on demand')
- test('caches generated variant')
- test('returns existing variant if available')
- test('dispatches variant generation job')
```

---

##### 2.2.18. EloquentMediaRepository

**–ü—É—Ç—å:** `app/Domain/Media/EloquentMediaRepository.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/EloquentMediaRepositoryTest.php`)

```php
- test('builds query with filters')
- test('paginates results')
- test('gets all results')
- test('filters by deleted')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Media/MediaRepositoryTest.php`)

```php
- test('repository filters media correctly')
- test('repository includes trashed when requested')
- test('repository paginates results')
```

---

##### 2.2.19. MediaQuery

**–ü—É—Ç—å:** `app/Domain/Media/MediaQuery.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/MediaQueryTest.php`)

```php
- test('builds query from request')
- test('applies filters')
- test('applies search')
- test('applies sorting')
```

---

##### 2.2.20. MediaDeletedFilter

**–ü—É—Ç—å:** `app/Domain/Media/MediaDeletedFilter.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/MediaDeletedFilterTest.php`)

```php
- test('filters only deleted')
- test('filters only not deleted')
- test('filters all including deleted')
```

---

##### 2.2.21. MediaVariantStatus (Enum)

**–ü—É—Ç—å:** `app/Domain/Media/MediaVariantStatus.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/MediaVariantStatusTest.php`)

```php
- test('has pending status')
- test('has processing status')
- test('has completed status')
- test('has failed status')
- test('can be cast to string')
```

---

##### 2.2.22. MediaMetadataDTO

**–ü—É—Ç—å:** `app/Domain/Media/DTO/MediaMetadataDTO.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/DTO/MediaMetadataDTOTest.php`)

```php
- test('creates dto with all properties')
- test('converts to array')
- test('validates required fields')
```

---

##### 2.2.23. Events: MediaUploaded, MediaProcessed, MediaDeleted

**–ü—É—Ç—å:** `app/Domain/Media/Events/`

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Media/MediaEventsTest.php`)

```php
- test('media uploaded event is dispatched on upload')
- test('media processed event is dispatched after processing')
- test('media deleted event is dispatched on deletion')
- test('event listeners are triggered correctly')
```

---

##### 2.2.24. Listeners: LogMediaEvent, NotifyMediaEvent, PurgeCdnCache

**–ü—É—Ç—å:** `app/Domain/Media/Listeners/`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Listeners/*Test.php`)

```php
// LogMediaEvent
- test('logs media event to file')
- test('includes event details in log')

// NotifyMediaEvent
- test('sends notification on media event')
- test('notifies correct users')

// PurgeCdnCache
- test('purges cdn cache on media change')
- test('sends correct purge request')
```

---

##### 2.2.25. GenerateVariantJob

**–ü—É—Ç—å:** `app/Domain/Media/Jobs/GenerateVariantJob.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Jobs/GenerateVariantJobTest.php`)

```php
- test('job generates variant')
- test('job updates variant status to processing')
- test('job updates variant status to completed on success')
- test('job updates variant status to failed on error')
- test('job stores generated file')
- test('job can be retried on failure')
```

---

### 2.3. –ú–æ–¥—É–ª—å Entries (1 —Å—É—â–Ω–æ—Å—Ç—å)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥ –í—ã—Å–æ–∫–∏–π

##### 2.3.1. PublishingService

**–ü—É—Ç—å:** `app/Domain/Entries/PublishingService.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Entries/PublishingServiceTest.php`)

```php
- test('publishes entry immediately')
- test('schedules entry for future publishing')
- test('validates publishing date')
- test('changes entry status to published')
- test('dispatches entry published event')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Entries/EntryPublishingTest.php`)

```php
- test('entry can be published')
- test('entry can be scheduled for publishing')
- test('scheduled entry becomes published on date')
- test('entry can be unpublished')
```

---

### 2.4. –ú–æ–¥—É–ª—å Plugins (7 —Å—É—â–Ω–æ—Å—Ç–µ–π)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü° –°—Ä–µ–¥–Ω–∏–π

##### 2.4.1. PluginActivator

**–ü—É—Ç—å:** `app/Domain/Plugins/PluginActivator.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Plugins/PluginActivatorTest.php`)

```php
- test('enables plugin')
- test('disables plugin')
- test('validates plugin before enabling')
- test('throws exception if plugin already enabled')
- test('throws exception if plugin already disabled')
- test('dispatches plugin enabled event')
- test('dispatches plugin disabled event')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Plugins/PluginActivationTest.php`)

```php
- test('plugin activation flow')
- test('plugin deactivation flow')
- test('plugin routes are loaded after activation')
- test('plugin routes are removed after deactivation')
```

---

##### 2.4.2. PluginRegistry

**–ü—É—Ç—å:** `app/Domain/Plugins/PluginRegistry.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Plugins/PluginRegistryTest.php`)

```php
- test('registers plugin')
- test('unregisters plugin')
- test('gets all registered plugins')
- test('gets enabled plugins')
- test('gets disabled plugins')
- test('checks if plugin is registered')
```

---

##### 2.4.3. PluginsSynchronizer

**–ü—É—Ç—å:** `app/Domain/Plugins/Services/PluginsSynchronizer.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Plugins/Services/PluginsSynchronizerTest.php`)

```php
- test('syncs plugins from filesystem')
- test('creates new plugin records')
- test('updates existing plugin records')
- test('validates plugin manifests')
- test('dispatches plugins synced event')
```

---

##### 2.4.4. PluginsRouteReloader

**–ü—É—Ç—å:** `app/Domain/Plugins/Services/PluginsRouteReloader.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Plugins/Services/PluginsRouteReloaderTest.php`)

```php
- test('reloads plugin routes')
- test('clears route cache')
- test('loads routes from enabled plugins')
- test('throws exception on reload failure')
```

---

##### 2.4.5. PluginAutoloader

**–ü—É—Ç—å:** `app/Domain/Plugins/Services/PluginAutoloader.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Plugins/Services/PluginAutoloaderTest.php`)

```php
- test('registers plugin autoloader')
- test('loads plugin classes')
- test('handles plugin namespace')
```

---

##### 2.4.6. PluginsSyncCommand

**–ü—É—Ç—å:** `app/Domain/Plugins/Commands/PluginsSyncCommand.php`

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Plugins/PluginsSyncCommandTest.php`)

```php
- test('command syncs plugins')
- test('command output shows sync results')
```

---

##### 2.4.7. Plugin Events & Exceptions

**–ü—É—Ç—å:** `app/Domain/Plugins/Events/`, `app/Domain/Plugins/Exceptions/`

**Unit-—Ç–µ—Å—Ç—ã**

```php
// Events
- test('plugin enabled event is dispatched')
- test('plugin disabled event is dispatched')
- test('plugins synced event is dispatched')
- test('plugins routes reloaded event is dispatched')

// Exceptions
- test('invalid plugin manifest exception')
- test('plugin already enabled exception')
- test('plugin already disabled exception')
- test('routes reload failed exception')
```

---

### 2.5. –ú–æ–¥—É–ª—å Routing (9 —Å—É—â–Ω–æ—Å—Ç–µ–π)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü° –°—Ä–µ–¥–Ω–∏–π

##### 2.5.1. PathReservationService

**–ü—É—Ç—å:** `app/Domain/Routing/PathReservationServiceImpl.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Routing/PathReservationServiceTest.php`)

```php
- test('reserves path')
- test('releases path')
- test('checks if path is reserved')
- test('throws exception on duplicate reservation')
- test('validates path format')
- test('normalizes path before reservation')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Routing/PathReservationTest.php`)

```php
- test('path can be reserved')
- test('reserved path cannot be used by entry')
- test('path can be released')
- test('released path can be reused')
- test('system paths are automatically reserved')
- test('plugin paths are reserved on activation')
```

---

##### 2.5.2. PathReservationStore

**–ü—É—Ç—å:** `app/Domain/Routing/PathReservationStoreImpl.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Routing/PathReservationStoreTest.php`)

```php
- test('stores path reservation')
- test('retrieves path reservation')
- test('removes path reservation')
- test('checks if path exists')
```

---

##### 2.5.3. PathNormalizer

**–ü—É—Ç—å:** `app/Domain/Routing/PathNormalizer.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Routing/PathNormalizerTest.php`)

```php
- test('normalizes path with leading slash')
- test('normalizes path without trailing slash')
- test('normalizes multiple slashes')
- test('converts to lowercase')
- test('handles unicode characters')
```

---

##### 2.5.4. ReservedRouteRegistry

**–ü—É—Ç—å:** `app/Domain/Routing/ReservedRouteRegistry.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Routing/ReservedRouteRegistryTest.php`)

```php
- test('registers reserved route')
- test('gets all reserved routes')
- test('checks if path is in registry')
```

---

##### 2.5.5. ReservedPattern

**–ü—É—Ç—å:** `app/Domain/Routing/ReservedPattern.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Routing/ReservedPatternTest.php`)

```php
- test('creates pattern with path')
- test('creates pattern with prefix')
- test('matches exact path')
- test('matches path prefix')
```

---

##### 2.5.6. Routing Exceptions

**–ü—É—Ç—å:** `app/Domain/Routing/Exceptions/`

**Unit-—Çes—Ç—ã**

```php
- test('path already reserved exception')
- test('invalid path exception')
- test('forbidden reservation release exception')
```

---

### 2.6. –ú–æ–¥—É–ª—å Search (9 —Å—É—â–Ω–æ—Å—Ç–µ–π)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü° –°—Ä–µ–¥–Ω–∏–π

##### 2.6.1. SearchService

**–ü—É—Ç—å:** `app/Domain/Search/SearchService.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Search/SearchServiceTest.php`)

```php
- test('searches entries')
- test('applies filters to search')
- test('applies sorting to results')
- test('paginates search results')
- test('returns search result object')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Search/SearchQueryTest.php`)

```php
- test('search returns relevant entries')
- test('search filters by post type')
- test('search filters by date range')
- test('search filters by terms')
- test('search highlights matched text')
```

---

##### 2.6.2. IndexManager

**–ü—É—Ç—å:** `app/Domain/Search/IndexManager.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Search/IndexManagerTest.php`)

```php
- test('creates search index')
- test('deletes search index')
- test('updates index mappings')
- test('reindexes all entries')
- test('indexes single entry')
- test('removes entry from index')
- test('swaps index alias')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Search/SearchIndexingTest.php`)

```php
- test('new entry is indexed automatically')
- test('updated entry is reindexed')
- test('deleted entry is removed from index')
- test('full reindex updates all entries')
- test('zero-downtime reindexing with alias swap')
```

---

##### 2.6.3. ElasticsearchSearchClient

**–ü—É—Ç—å:** `app/Domain/Search/Clients/ElasticsearchSearchClient.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Search/Clients/ElasticsearchSearchClientTest.php`)

```php
- test('sends search request to elasticsearch')
- test('creates index via api')
- test('deletes index via api')
- test('updates aliases via api')
- test('gets indices for alias')
- test('performs bulk operations')
- test('refreshes index')
- test('handles http errors')
- test('supports basic auth')
```

---

##### 2.6.4. NullSearchClient

**–ü—É—Ç—å:** `app/Domain/Search/Clients/NullSearchClient.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Search/Clients/NullSearchClientTest.php`)

```php
- test('returns empty results')
- test('does nothing on index operations')
```

---

##### 2.6.5. EntryToSearchDoc

**–ü—É—Ç—å:** `app/Domain/Search/Transformers/EntryToSearchDoc.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Search/Transformers/EntryToSearchDocTest.php`)

```php
- test('transforms entry to search document')
- test('extracts text from data_json')
- test('normalizes whitespace in content')
- test('generates excerpt from content')
- test('includes entry metadata')
- test('includes post type information')
- test('includes terms information')
```

---

##### 2.6.6. SearchQuery, SearchResult, SearchHit

**–ü—É—Ç—å:** `app/Domain/Search/`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Search/SearchQueryTest.php`, etc.)

```php
// SearchQuery
- test('builds query from parameters')
- test('adds filters to query')
- test('adds sorting to query')
- test('sets pagination')

// SearchResult
- test('contains hits')
- test('contains total count')
- test('contains aggregations')

// SearchHit
- test('wraps search result item')
- test('provides score')
- test('provides highlights')
```

---

##### 2.6.7. SearchTermFilter

**–ü—É—Ç—å:** `app/Domain/Search/ValueObjects/SearchTermFilter.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Search/ValueObjects/SearchTermFilterTest.php`)

```php
- test('creates filter from term id')
- test('converts to elasticsearch filter')
```

---

##### 2.6.8. ReindexSearchJob

**–ü—É—Ç—å:** `app/Domain/Search/Jobs/ReindexSearchJob.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Search/Jobs/ReindexSearchJobTest.php`)

```php
- test('job reindexes all entries')
- test('job handles large datasets')
- test('job can be retried on failure')
```

---

##### 2.6.9. SearchReindexCommand

**–ü—É—Ç—å:** `app/Domain/Search/Commands/SearchReindexCommand.php`

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Search/SearchReindexCommandTest.php`)

```php
- test('command triggers reindex')
- test('command shows progress')
- test('command dispatches reindex job')
```

---

### 2.7. –ú–æ–¥—É–ª—å View (2 —Å—É—â–Ω–æ—Å—Ç–∏)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü¢ –ù–∏–∑–∫–∏–π

##### 2.7.1. BladeTemplateResolver

**–ü—É—Ç—å:** `app/Domain/View/BladeTemplateResolver.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/View/BladeTemplateResolverTest.php`)

```php
- test('resolves template for entry with override')
- test('resolves template by post type and slug')
- test('resolves template by post type')
- test('falls back to global entry template')
- test('checks view existence')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/View/TemplateResolutionTest.php`)

```php
- test('entry renders with correct template')
- test('custom template override is respected')
- test('post type specific template is used')
- test('fallback template is used when no specific template exists')
```

---

### 2.8. –ú–æ–¥—É–ª—å Sanitizer (1 —Å—É—â–Ω–æ—Å—Ç—å)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü° –°—Ä–µ–¥–Ω–∏–π

##### 2.8.1. RichTextSanitizer

**–ü—É—Ç—å:** `app/Domain/Sanitizer/RichTextSanitizer.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Sanitizer/RichTextSanitizerTest.php`)

```php
- test('sanitizes html content')
- test('removes dangerous tags')
- test('removes javascript')
- test('allows safe tags')
- test('preserves formatting')
- test('handles malformed html')
```

---

### 2.9. –ú–æ–¥—É–ª—å Options (1 —Å—É—â–Ω–æ—Å—Ç—å)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü¢ –ù–∏–∑–∫–∏–π

##### 2.9.1. OptionsRepository

**–ü—É—Ç—å:** `app/Domain/Options/OptionsRepository.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Options/OptionsRepositoryTest.php`)

```php
- test('gets option by namespace and key')
- test('sets option value')
- test('deletes option')
- test('gets all options in namespace')
- test('returns default if option not found')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Options/OptionsManagementTest.php`)

```php
- test('option can be created and retrieved')
- test('option can be updated')
- test('option can be deleted')
- test('options are scoped by namespace')
```

---

### 2.10. –ú–æ–¥—É–ª—å PostTypes (1 —Å—É—â–Ω–æ—Å—Ç—å)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü¢ –ù–∏–∑–∫–∏–π

##### 2.10.1. PostTypeOptions

**–ü—É—Ç—å:** `app/Domain/PostTypes/PostTypeOptions.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/PostTypes/PostTypeOptionsTest.php`)

```php
- test('creates options from array')
- test('converts options to array')
- test('validates option structure')
```

---

## 3. HTTP Controllers (60 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤)

### 3.1. Auth API (4 —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Auth/AuthenticationTest.php`)

```php
// POST /api/v1/admin/auth/login
- test('user can login with valid credentials')
- test('user receives access and refresh tokens on login')
- test('login fails with invalid credentials')
- test('login fails with missing credentials')

// GET /api/v1/admin/auth/current
- test('authenticated user can get current user info')
- test('unauthenticated request returns 401')

// POST /api/v1/admin/auth/refresh
- test('user can refresh access token with valid refresh token')
- test('refresh token is rotated on use')
- test('refresh fails with invalid token')
- test('refresh fails with expired token')
- test('refresh fails with revoked token')

// POST /api/v1/admin/auth/logout
- test('user can logout')
- test('refresh token is revoked on logout')
- test('access token becomes invalid after logout')
```

---

### 3.2. Entries API (10 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥ –í—ã—Å–æ–∫–∏–π

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Admin/V1/Entries/EntryManagementTest.php`)

```php
// GET /api/v1/admin/entries
- test('admin can list entries')
- test('entries are paginated')
- test('entries can be filtered by post type')
- test('entries can be filtered by status')
- test('entries can be searched')
- test('unauthenticated request returns 401')

// POST /api/v1/admin/entries
- test('admin can create entry')
- test('entry is created with correct data')
- test('entry validation fails with invalid data')
- test('entry slug is auto-generated')
- test('entry slug must be unique per post type')
- test('unauthenticated request returns 401')

// GET /api/v1/admin/entries/{id}
- test('admin can view entry')
- test('entry includes relationships')
- test('not found returns 404')

// PUT /api/v1/admin/entries/{id}
- test('admin can update entry')
- test('entry data is updated correctly')
- test('entry validation works on update')
- test('not found returns 404')

// DELETE /api/v1/admin/entries/{id}
- test('admin can soft delete entry')
- test('deleted entry is not in default list')
- test('not found returns 404')

// POST /api/v1/admin/entries/{id}/restore
- test('admin can restore deleted entry')
- test('restored entry appears in default list')

// GET /api/v1/admin/entries/statuses
- test('admin can get available statuses')
- test('returns list of valid status values')

// GET /api/v1/admin/entries/{entry}/terms
- test('admin can get entry terms')
- test('terms are grouped by taxonomy')

// PUT /api/v1/admin/entries/{entry}/terms/sync
- test('admin can sync entry terms')
- test('old terms are removed')
- test('new terms are attached')
```

---

### 3.3. Media API (13 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥ –í—ã—Å–æ–∫–∏–π

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Admin/V1/Media/MediaManagementTest.php`)

```php
// GET /api/v1/admin/media
- test('admin can list media')
- test('media are paginated')
- test('media can be filtered by mime type')
- test('media can be filtered by collection')
- test('media can be searched')

// POST /api/v1/admin/media
- test('admin can upload media')
- test('media file is stored')
- test('media metadata is extracted')
- test('media validation works')
- test('upload fails with invalid file')
- test('upload fails with oversized file')

// GET /api/v1/admin/media/{id}
- test('admin can view media')
- test('media includes variants')
- test('media includes metadata')
- test('not found returns 404')

// PUT /api/v1/admin/media/{id}
- test('admin can update media metadata')
- test('title can be updated')
- test('alt text can be updated')

// DELETE /api/v1/admin/media/{id}
- test('admin can soft delete media')
- test('media file remains on disk')
- test('deleted media not in default list')

// POST /api/v1/admin/media/{id}/restore
- test('admin can restore deleted media')

// GET /api/v1/admin/media/{id}/variants
- test('admin can get media variants')
- test('variants include status information')

// POST /api/v1/admin/media/{id}/variants
- test('admin can request new variant')
- test('variant generation job is dispatched')

// GET /api/v1/media/{disk}/{path}
- test('public can access media file')
- test('correct file is returned')
- test('correct mime type header')
- test('not found returns 404')
```

---

### 3.4. PostTypes API (5 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü° –°—Ä–µ–¥–Ω–∏–π

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Admin/V1/PostTypes/PostTypesManagementTest.php`)

```php
// GET /api/v1/admin/post-types
- test('admin can list post types')

// POST /api/v1/admin/post-types
- test('admin can create post type')
- test('post type slug is unique')

// GET /api/v1/admin/post-types/{id}
- test('admin can view post type')

// PUT /api/v1/admin/post-types/{id}
- test('admin can update post type')

// DELETE /api/v1/admin/post-types/{id}
- test('admin can delete post type')
- test('cannot delete post type with entries')
```

---

### 3.5. Plugins API (4 —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü° –°—Ä–µ–¥–Ω–∏–π

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Admin/V1/Plugins/PluginsManagementTest.php`)

```php
// GET /api/v1/admin/plugins
- test('admin can list plugins')
- test('plugins include enabled status')

// POST /api/v1/admin/plugins/{id}/enable
- test('admin can enable plugin')
- test('plugin routes are loaded')

// POST /api/v1/admin/plugins/{id}/disable
- test('admin can disable plugin')
- test('plugin routes are removed')

// POST /api/v1/admin/plugins/sync
- test('admin can sync plugins from filesystem')
- test('new plugins are discovered')
- test('removed plugins are deleted')
```

---

### 3.6. Options API (3 —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü¢ –ù–∏–∑–∫–∏–π

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Admin/V1/Options/OptionsManagementTest.php`)

```php
// GET /api/v1/admin/options
- test('admin can get options')
- test('options can be filtered by namespace')

// PUT /api/v1/admin/options
- test('admin can update options')
- test('multiple options can be updated at once')

// DELETE /api/v1/admin/options/{id}
- test('admin can delete option')
```

---

### 3.7. Taxonomies & Terms API (8 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü° –°—Ä–µ–¥–Ω–∏–π

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Admin/V1/Taxonomies/TaxonomiesManagementTest.php`)

```php
// GET /api/v1/admin/taxonomies
- test('admin can list taxonomies')

// POST /api/v1/admin/taxonomies
- test('admin can create taxonomy')

// GET /api/v1/admin/taxonomies/{id}
- test('admin can view taxonomy')

// PUT /api/v1/admin/taxonomies/{id}
- test('admin can update taxonomy')

// DELETE /api/v1/admin/taxonomies/{id}
- test('admin can delete taxonomy')
```

**Feature-—Çes—Ç—ã** (`tests/Feature/Api/Admin/V1/Terms/TermsManagementTest.php`)

```php
// GET /api/v1/admin/terms
- test('admin can list terms')
- test('terms can be filtered by taxonomy')

// POST /api/v1/admin/terms
- test('admin can create term')
- test('term can have parent')

// GET /api/v1/admin/terms/{id}
- test('admin can view term')
- test('term includes ancestors and descendants')

// PUT /api/v1/admin/terms/{id}
- test('admin can update term')
- test('term hierarchy can be changed')
- test('circular hierarchy is prevented')

// DELETE /api/v1/admin/terms/{id}
- test('admin can delete term')
- test('term children are handled correctly')
```

---

### 3.8. Search API (2 —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü° –°—Ä–µ–¥–Ω–∏–π

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Admin/V1/Search/SearchAdminTest.php`)

```php
// GET /api/v1/admin/search
- test('admin can search entries')
- test('search returns relevant results')

// POST /api/v1/admin/search/reindex
- test('admin can trigger reindex')
- test('reindex job is dispatched')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Public/Search/PublicSearchTest.php`)

```php
// GET /api/v1/search
- test('public can search published entries')
- test('draft entries are not in results')
- test('search results are paginated')
```

---

### 3.9. Path Reservation API (3 —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü° –°—Ä–µ–¥–Ω–∏–π

**Feature-—Çes—Ç—ã** (`tests/Feature/Api/Admin/V1/PathReservations/PathReservationTest.php`)

```php
// GET /api/v1/admin/reserved-paths
- test('admin can list reserved paths')

// POST /api/v1/admin/reserved-paths
- test('admin can reserve path')
- test('duplicate path returns error')

// DELETE /api/v1/admin/reserved-paths/{id}
- test('admin can release path reservation')
- test('system paths cannot be released')
```

---

### 3.10. Utils & Templates API (3 —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü¢ –ù–∏–∑–∫–∏–π

**Feature-—Çes—Ç—ã** (`tests/Feature/Api/Admin/V1/Utils/UtilsTest.php`)

```php
// GET /api/v1/admin/utils/slug
- test('generates slug from title')

// GET /api/v1/admin/templates
- test('lists available blade templates')
```

---

### 3.11. Web Controllers (3 –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü¢ –ù–∏–∑–∫–∏–π

**Feature-—Çes—Ç—ã** (`tests/Feature/Web/PagesTest.php`)

```php
// GET /
- test('homepage renders')
- test('homepage uses correct template')

// GET /{slug}
- test('entry page renders')
- test('entry uses correct template')
- test('not found returns 404')

// GET /admin (ping)
- test('admin ping returns ok')
```

---

## 4. Validation Rules (6 –ø—Ä–∞–≤–∏–ª)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü° –°—Ä–µ–¥–Ω–∏–π

#### 4.1. UniqueEntrySlug

**–ü—É—Ç—å:** `app/Rules/UniqueEntrySlug.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Rules/UniqueEntrySlugTest.php`)

```php
- test('passes for unique slug')
- test('fails for duplicate slug in same post type')
- test('passes for duplicate slug in different post type')
- test('passes for same entry on update')
```

---

#### 4.2. ReservedSlug

**–ü—É—Ç—å:** `app/Rules/ReservedSlug.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Rules/ReservedSlugTest.php`)

```php
- test('passes for non-reserved slug')
- test('fails for reserved path')
- test('fails for reserved prefix')
```

---

#### 4.3. Publishable

**–ü—É—Ç—å:** `app/Rules/Publishable.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Rules/PublishableTest.php`)

```php
- test('passes for valid publishable state')
- test('fails if required fields missing')
```

---

#### 4.4. PublishedDateNotInFuture

**–ü—É—Ç—å:** `app/Rules/PublishedDateNotInFuture.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Rules/PublishedDateNotInFutureTest.php`)

```php
- test('passes for past date')
- test('passes for current date')
- test('fails for future date')
```

---

#### 4.5. NoTermCycle

**–ü—É—Ç—å:** `app/Rules/NoTermCycle.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Rules/NoTermCycleTest.php`)

```php
- test('passes for non-cyclic hierarchy')
- test('fails for direct cycle')
- test('fails for indirect cycle')
```

---

#### 4.6. JsonValue

**–ü—É—Ç—å:** `app/Rules/JsonValue.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Rules/JsonValueTest.php`)

```php
- test('passes for valid json')
- test('passes for null')
- test('fails for invalid json')
```

---

## 5. Integration Tests

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Integration/`)

#### 5.1. MediaProcessingPipelineTest.php

```php
- test('complete media processing pipeline')
- test('image upload, validation, storage, variant generation')
- test('video upload with metadata extraction')
- test('pdf upload and validation')
```

---

#### 5.2. SearchReindexingTest.php

```php
- test('full reindex updates all entries')
- test('zero-downtime reindex with alias swap')
- test('incremental indexing on entry changes')
```

---

#### 5.3. PluginSystemTest.php

```php
- test('plugin activation loads routes')
- test('plugin deactivation removes routes')
- test('plugin sync discovers new plugins')
```

---

#### 5.4. EntryLifecycleTest.php

```php
- test('entry creation, publishing, updating, deletion')
- test('entry with terms')
- test('entry slug reservation and validation')
```

---

## 6. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (1-2 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –ü–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–∞–º–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ —á–∞—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

1. ‚úÖ **Auth Module** (JwtService, RefreshTokenRepository)
2. ‚úÖ **Models** (User, Entry, Media, PostType)
3. ‚úÖ **Media Actions** (MediaStoreAction, MediaValidation)
4. ‚úÖ **Auth API** (Login, Refresh, Logout)
5. ‚úÖ **Entries API** (CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏)

### –§–∞–∑–∞ 2: –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (2-3 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –ü–æ–∫—Ä—ã—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É

1. **Media Module** (–≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã)
2. **Media API** (–∑–∞–≥—Ä—É–∑–∫–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
3. **–û—Å—Ç–∞–ª—å–Ω—ã–µ Models** (–≤—Å–µ 16 –º–æ–¥–µ–ª–µ–π)
4. **Search Module** (–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è, –ø–æ–∏—Å–∫)
5. **Routing Module** (—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É—Ç–µ–π)

### –§–∞–∑–∞ 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (1-2 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –ü–æ–∫—Ä—ã—Ç—å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏

1. **Plugins Module** (–∞–∫—Ç–∏–≤–∞—Ü–∏—è, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)
2. **PostTypes, Taxonomies, Terms API**
3. **Options Module**
4. **Validation Rules**
5. **View Module**

### –§–∞–∑–∞ 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (1 –Ω–µ–¥–µ–ª—è)

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

1. **MediaProcessingPipeline**
2. **SearchReindexing**
3. **PluginSystem**
4. **EntryLifecycle**

---

## 7. –ú–µ—Ç—Ä–∏–∫–∏ –∏ —Ü–µ–ª–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

### –¶–µ–ª–µ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ

-   **Unit-—Ç–µ—Å—Ç—ã:** 80%+ –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
-   **Feature-—Ç–µ—Å—Ç—ã:** 100% –ø–æ–∫—Ä—ã—Ç–∏–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
-   **Models:** 100% –ø–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
-   **Integration:** –ü–æ–∫—Ä—ã—Ç–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

-   –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
-   –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Unit-—Ç–µ—Å—Ç–æ–≤ < 30 —Å–µ–∫
-   –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Feature-—Ç–µ—Å—Ç–æ–≤ < 2 –º–∏–Ω
-   –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ < 3 –º–∏–Ω

---

## 8. –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
composer test

# –ü–æ —Ç–∏–ø–∞–º
composer test:unit
composer test:feature

# –ü–æ –º–æ–¥—É–ª—è–º
composer test:module:auth
composer test:module:media
composer test:module:entries
composer test:module:plugins
composer test:module:search

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
composer test:coverage
php artisan test --coverage --min=80

# –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
composer test:parallel
```

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

```bash
# Unit-—Ç–µ—Å—Ç
php artisan make:test Unit/Domain/Media/Services/ExifManagerTest --unit

# Feature-—Ç–µ—Å—Ç
php artisan make:test Feature/Api/Admin/V1/Media/MediaManagementTest
```

---

## 9. –®–∞–±–ª–æ–Ω—ã —Ç–µ—Å—Ç–æ–≤

### Unit-—Ç–µ—Å—Ç (Action)

```php
<?php

declare(strict_types=1);

use App\Domain\Media\Actions\MediaStoreAction;
use Illuminate\Http\UploadedFile;

test('stores media file successfully', function () {
    // Arrange
    $action = app(MediaStoreAction::class);
    $file = UploadedFile::fake()->image('test.jpg');

    // Act
    $media = $action->execute($file, 'default');

    // Assert
    expect($media)
        ->toBeInstanceOf(Media::class)
        ->and($media->mime_type)->toBe('image/jpeg')
        ->and($media->exists)->toBeTrue();
});
```

### Feature-—Ç–µ—Å—Ç (API)

```php
<?php

declare(strict_types=1);

use App\Models\User;
use Illuminate\Http\UploadedFile;
use function Pest\Laravel\postJson;

test('admin can upload media', function () {
    // Arrange
    $admin = User::factory()->admin()->create();
    $file = UploadedFile::fake()->image('photo.jpg', 1920, 1080);

    // Act
    $response = $this->actingAs($admin, 'jwt')
        ->postJson('/api/v1/admin/media', [
            'file' => $file,
            'title' => 'Test Photo',
            'collection' => 'default',
        ]);

    // Assert
    $response->assertStatus(201)
        ->assertJsonStructure([
            'data' => ['id', 'title', 'url', 'mime_type'],
        ]);

    $this->assertDatabaseHas('media', [
        'title' => 'Test Photo',
        'mime_type' => 'image/jpeg',
    ]);
});
```

---

## 10. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–î–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –ø–æ–∫—Ä—ã–≤–∞–µ—Ç **–≤—Å–µ 170 —Å—É—â–Ω–æ—Å—Ç–µ–π –ø—Ä–æ–µ–∫—Ç–∞**:

-   ‚úÖ 16 –º–æ–¥–µ–ª–µ–π
-   ‚úÖ 63 –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞
-   ‚úÖ 60 HTTP —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
-   ‚úÖ 6 –ø—Ä–∞–≤–∏–ª –≤–∞–ª–∏–¥–∞—Ü–∏–∏
-   ‚úÖ –°–æ–±—ã—Ç–∏—è, —Å–ª—É—à–∞—Ç–µ–ª–∏, jobs
-   ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

–ü–ª–∞–Ω —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω –ø–æ –º–æ–¥—É–ª—è–º, –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –ø–æ—ç—Ç–∞–ø–Ω–æ–º—É –≤–Ω–µ–¥—Ä–µ–Ω–∏—é.

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—á–∞—Ç—å —Å –§–∞–∑—ã 1 (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã) —Å–æ–≥–ª–∞—Å–Ω–æ –ø–ª–∞–Ω—É –≤–Ω–µ–¥—Ä–µ–Ω–∏—è.

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∞:** –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

---

_–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 2025-11-17_  
_–í–µ—Ä—Å–∏—è: 1.0_
