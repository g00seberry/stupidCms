# –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π –ø—Ä–æ–µ–∫—Ç–∞ stupidCMS

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-17  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** üìã –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

---

## –û–±–∑–æ—Ä

–î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—é —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π –ø—Ä–æ–µ–∫—Ç–∞ stupidCMS.  
–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç **170 —Å—É—â–Ω–æ—Å—Ç–µ–π**: 16 –º–æ–¥–µ–ª–µ–π, 63 –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞, 60 HTTP —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤, –∏ –¥—Ä.

### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–ü–æ–ª–Ω–æ—Ç–∞:** –ö–∞–∂–¥–∞—è —Å—É—â–Ω–æ—Å—Ç—å –∏–º–µ–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã
2. **–ò–∑–æ–ª—è—Ü–∏—è:** Unit-—Ç–µ—Å—Ç—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –æ—Ç –ë–î –∏ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å:** Feature-—Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
4. **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å:** –¢–µ—Å—Ç—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã –ø–æ –¥–æ–º–µ–Ω–Ω—ã–º –º–æ–¥—É–ª—è–º
5. **–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è:** –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ç–µ—Å—Ç–∏—Ä—É—é—Ç—Å—è –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-11-17

### –û–±—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

-   ‚úÖ **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤:** 796
-   ‚úÖ **Assertions:** 2009
-   ‚è≠Ô∏è **Skipped:** 3
-   ‚ùå **Failed:** 0
-   ‚è±Ô∏è **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~51 —Å–µ–∫

### –ü–æ —Ñ–∞–∑–∞–º

#### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã ‚úÖ (100%)

-   ‚úÖ **Models:** 218 —Ç–µ—Å—Ç–æ–≤ (User, Entry, Media, PostType, Plugin, Option, Taxonomy, Term, TermTree, RefreshToken, ReservedRoute, Redirect, Audit, Outbox + MediaVariant, MediaMetadata)
-   ‚úÖ **Auth Module:** 26 —Ç–µ—Å—Ç–æ–≤ (JwtService, RefreshTokenRepository, RefreshTokenDto, Exceptions)

#### –§–∞–∑–∞ 2: Domain Services üîÑ (33%)

-   ‚úÖ **Auth:** 26 —Ç–µ—Å—Ç–æ–≤
-   ‚úÖ **Entries:** 16 —Ç–µ—Å—Ç–æ–≤ (PublishingService)
-   ‚úÖ **Routing:** 37 —Ç–µ—Å—Ç–æ–≤ (PathNormalizer, ReservedPattern, Exceptions)
-   ‚úÖ **Media:** 21 —Ç–µ—Å—Ç–æ–≤ (MediaQuery, ListMediaAction, UpdateMediaMetadataAction)
-   ‚úÖ **Options:** 16 —Ç–µ—Å—Ç–æ–≤ (OptionsRepository)
-   ‚úÖ **PostTypes:** 19 —Ç–µ—Å—Ç–æ–≤ (PostTypeOptions)
-   ‚úÖ **Sanitizer:** 17 —Ç–µ—Å—Ç–æ–≤ (RichTextSanitizer)
-   ‚úÖ **View:** 10 —Ç–µ—Å—Ç–æ–≤ (BladeTemplateResolver)
-   ‚úÖ **Plugins:** 7 —Ç–µ—Å—Ç–æ–≤ (PluginRegistry)
-   ‚è≥ **Media (–ø–æ–ª–Ω–æ–µ):** MediaStoreAction —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏
-   ‚è≥ **Plugins (–ø–æ–ª–Ω–æ–µ):** PluginActivator —Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

#### –§–∞–∑–∞ 3: HTTP Controllers ‚úÖ (100%)

-   ‚úÖ **Auth API:** 31 —Ç–µ—Å—Ç (Login, CurrentUser, Refresh, Logout)
-   ‚úÖ **Entries API:** 53 —Ç–µ—Å—Ç–∞ (List, Create, Show, Update, Delete, Restore)
-   ‚úÖ **Media API:** 35 —Ç–µ—Å—Ç–æ–≤ (List, Show, Update, Delete, Restore)
-   ‚úÖ **PostTypes API:** 17 —Ç–µ—Å—Ç–æ–≤ (List, Create, Show, Update, Delete)
-   ‚úÖ **Plugins API:** 31 —Ç–µ—Å—Ç (List, Enable, Disable, Sync)
-   ‚úÖ **Options API:** 22 —Ç–µ—Å—Ç–∞ (List, Show, Upsert, Delete, Restore)
-   ‚úÖ **Taxonomies & Terms API:** 37 —Ç–µ—Å—Ç–æ–≤ (Taxonomies 19, Terms 18)
-   ‚úÖ **Search API:** 24 —Ç–µ—Å—Ç–∞ (Public 15, Admin 9)
-   ‚úÖ **Path Reservation API:** 21 —Ç–µ—Å—Ç (List, Reserve, Release)
-   ‚úÖ **Utils & Templates API:** 27 —Ç–µ—Å—Ç–æ–≤ (Utils 10, Templates 17)
-   ‚úÖ **Web Controllers:** 15 —Ç–µ—Å—Ç–æ–≤ (Home 5, Page 7, Ping 2, Routing 1)

#### –§–∞–∑–∞ 4: Validation Rules ‚úÖ (100%)

-   ‚úÖ **UniqueEntrySlug:** 8 —Ç–µ—Å—Ç–æ–≤
-   ‚úÖ **ReservedSlug:** 9 —Ç–µ—Å—Ç–æ–≤
-   ‚úÖ **Publishable:** 7 —Ç–µ—Å—Ç–æ–≤ (1 skipped)
-   ‚úÖ **PublishedDateNotInFuture:** 7 —Ç–µ—Å—Ç–æ–≤
-   ‚úÖ **NoTermCycle:** 7 —Ç–µ—Å—Ç–æ–≤
-   ‚úÖ **JsonValue:** 13 —Ç–µ—Å—Ç–æ–≤

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–ª–∞–Ω–∞

```
1. Models (16 —Å—É—â–Ω–æ—Å—Ç–µ–π)
   ‚îú‚îÄ‚îÄ Unit-—Ç–µ—Å—Ç—ã (scopes, accessors, mutators, relations)
   ‚îî‚îÄ‚îÄ Feature-—Ç–µ—Å—Ç—ã (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ë–î)

2. Domain Services (63 —Å—É—â–Ω–æ—Å—Ç–∏)
   ‚îú‚îÄ‚îÄ Actions (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏)
   ‚îú‚îÄ‚îÄ Services (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤)
   ‚îú‚îÄ‚îÄ Repositories (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤)
   ‚îú‚îÄ‚îÄ Validators (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏)
   ‚îî‚îÄ‚îÄ Value Objects/DTOs

3. HTTP Controllers (60 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤)
   ‚îú‚îÄ‚îÄ Admin API (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, CRUD)
   ‚îî‚îÄ‚îÄ Public API (–ø—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)

4. Validation Rules (6 –ø—Ä–∞–≤–∏–ª)
   ‚îî‚îÄ‚îÄ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª

5. Events & Listeners (9 —Å–æ–±—ã—Ç–∏–π, 3 —Å–ª—É—à–∞—Ç–µ–ª—è)
   ‚îî‚îÄ‚îÄ Feature-—Ç–µ—Å—Ç—ã —Å–æ–±—ã—Ç–∏–π

6. Jobs (2 —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏)
   ‚îî‚îÄ‚îÄ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è jobs

7. Integration Tests
   ‚îî‚îÄ‚îÄ –ü–æ–ª–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```

---

## 1. Models (16 –º–æ–¥–µ–ª–µ–π)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥ –í—ã—Å–æ–∫–∏–π

–ú–æ–¥–µ–ª–∏ ‚Äî –æ—Å–Ω–æ–≤–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ç—Ä–µ–±—É—é—Ç –ø–æ–ª–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è.

#### 1.1. User ‚úÖ

**–ü—É—Ç—å:** `app/Models/User.php`  
**Factory:** `database/factories/UserFactory.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/UserTest.php`) ‚úÖ

```php
‚úÖ test('has fillable attributes')
‚úÖ test('guarded is_admin attribute')
‚úÖ test('has notifications relationship')
‚úÖ test('has entries relationship')
‚úÖ test('has refresh tokens relationship')
‚úÖ test('can check if user is admin')
‚úÖ test('can check if user is regular user')
‚úÖ test('password is cast to hashed')
‚úÖ test('is_admin is cast to boolean')
‚úÖ test('admin_permissions is cast to array')
‚úÖ test('email_verified_at is cast to datetime')
‚úÖ test('returns normalized admin permissions')
‚úÖ test('returns empty array when admin_permissions is null')
‚úÖ test('admin always has any permission')
‚úÖ test('regular user has permission if it is in the list')
‚úÖ test('can grant admin permissions')
‚úÖ test('grant admin permissions does not create duplicates')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/UserTest.php`) ‚úÖ

```php
‚úÖ test('user can be created with factory')
‚úÖ test('admin user can be created')
‚úÖ test('user can have multiple entries')
‚úÖ test('user can have multiple refresh tokens')
‚úÖ test('user password is hashed')
‚úÖ test('user email is unique')
‚úÖ test('user can have admin permissions')
‚úÖ test('user admin_permissions defaults to empty array')
‚úÖ test('user password and remember_token are hidden from serialization')
‚úÖ test('user email_verified_at is stored as datetime')
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª–∏:**

-   –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã `entries()` –∏ `refreshTokens()` –¥–ª—è —Å–≤—è–∑–µ–π
-   –û–±–Ω–æ–≤–ª—ë–Ω PHPDoc —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Å–≤—è–∑–µ–π

---

#### 1.2. Entry ‚úÖ

**–ü—É—Ç—å:** `app/Models/Entry.php`  
**Factory:** `database/factories/EntryFactory.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/EntryTest.php`) ‚úÖ

```php
‚úÖ test('casts data_json to array')
‚úÖ test('casts seo_json to array')
‚úÖ test('casts published_at to datetime')
‚úÖ test('has post type relationship')
‚úÖ test('has author relationship')
‚úÖ test('has terms many to many relationship')
‚úÖ test('has published scope')
‚úÖ test('has of type scope')
‚úÖ test('uses soft deletes')
‚úÖ test('has draft status constant')
‚úÖ test('has published status constant')
‚úÖ test('get statuses returns all statuses')
‚úÖ test('url method returns flat url for page type')
‚úÖ test('url method returns hierarchical url for non-page type')
‚úÖ test('has no guarded attributes')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/EntryTest.php`) ‚úÖ

```php
‚úÖ test('entry can be created with factory')
‚úÖ test('entry belongs to post type')
‚úÖ test('entry belongs to author')
‚úÖ test('entry can have multiple terms')
‚úÖ test('entry can be published')
‚úÖ test('entry can be draft')
‚úÖ test('entry can be soft deleted')
‚úÖ test('entry can be restored')
‚è≠Ô∏è test('entry slug is unique per post type') - skipped (requires real DB)
‚úÖ test('entry slug can be same for different post types')
‚úÖ test('entry published at can be in future')
‚úÖ test('entry data json stores custom fields')
‚úÖ test('entry seo json stores metadata')
‚úÖ test('published scope returns only published entries')
‚úÖ test('of type scope filters by post type slug')
‚úÖ test('entry url is generated correctly for page type')
‚úÖ test('entry url is generated correctly for non-page type')
‚úÖ test('entry template override can be set')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   –¢–µ—Å—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ slug –ø—Ä–æ–ø—É—â–µ–Ω, —Ç–∞–∫ –∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–π –ë–î —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ (–Ω–µ :memory:)
-   –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–¥–µ–ª–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

#### 1.3. Media ‚úÖ

**–ü—É—Ç—å:** `app/Models/Media.php`  
**Factory:** `database/factories/MediaFactory.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/MediaTest.php`) ‚úÖ

```php
‚úÖ test('uses ULID as primary key')
‚úÖ test('casts exif_json to array')
‚úÖ test('casts deleted_at to datetime')
‚úÖ test('casts width to integer')
‚úÖ test('casts height to integer')
‚úÖ test('casts duration_ms to integer')
‚úÖ test('casts size_bytes to integer')
‚úÖ test('has variants relationship')
‚úÖ test('has metadata relationship')
‚úÖ test('uses soft deletes')
‚úÖ test('kind returns image for image mime type')
‚úÖ test('kind returns video for video mime type')
‚úÖ test('kind returns audio for audio mime type')
‚úÖ test('kind returns document for other mime types')
‚úÖ test('has no guarded attributes')
‚úÖ test('uses HasUlids trait')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/MediaTest.php`) ‚úÖ

```php
‚úÖ test('media can be created with factory')
‚úÖ test('media has unique disk and path combination')
‚úÖ test('media can have multiple variants')
‚úÖ test('media can have metadata')
‚úÖ test('media can be soft deleted')
‚úÖ test('media can be restored after soft delete')
‚úÖ test('media exif json stores metadata')
‚úÖ test('media dimensions are stored correctly')
‚úÖ test('media file size is stored in bytes')
‚úÖ test('media kind method works for images')
‚úÖ test('media kind method works for documents')
‚úÖ test('media kind method works for video')
‚úÖ test('media kind method works for audio')
‚úÖ test('media can have null dimensions for non-image files')
‚úÖ test('media checksum is stored correctly')
‚úÖ test('media collection can be set')
‚úÖ test('media duration_ms can be set for video')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏
-   –ú–µ—Ç–æ–¥ `kind()` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ –ø–æ MIME
-   –°–≤—è–∑–∏ —Å MediaVariant –∏ MediaMetadata

---

#### 1.4. MediaVariant ‚úÖ

**–ü—É—Ç—å:** `app/Models/MediaVariant.php`  
**Factory:** `database/factories/MediaVariantFactory.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/MediaVariantTest.php`) ‚úÖ

```php
‚úÖ test('uses ULID as primary key')
‚úÖ test('casts status to MediaVariantStatus enum')
‚úÖ test('casts started_at to immutable_datetime')
‚úÖ test('casts finished_at to immutable_datetime')
‚úÖ test('belongs to media')
‚úÖ test('has no guarded attributes')
‚úÖ test('uses HasUlids trait')
‚úÖ test('table name is media_variants')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/MediaVariantTest.php`) ‚úÖ

```php
‚úÖ test('variant can be created with factory')
‚úÖ test('variant belongs to media')
‚úÖ test('variant status is cast to enum')
‚úÖ test('variant can have queued status')
‚úÖ test('variant can have processing status')
‚úÖ test('variant can have ready status')
‚úÖ test('variant can have failed status')
‚úÖ test('variant status transitions correctly')
‚úÖ test('variant can be marked as processing')
‚úÖ test('variant can be marked as ready')
‚úÖ test('variant can be marked as failed')
‚úÖ test('variant dimensions are stored correctly')
‚úÖ test('variant size_bytes is stored correctly')
‚úÖ test('variant path is unique')
‚úÖ test('variant name and media_id combination is unique')
‚úÖ test('variant started_at is immutable datetime')
‚úÖ test('variant finished_at is immutable datetime')
```

---

#### 1.5. MediaMetadata ‚úÖ

**–ü—É—Ç—å:** `app/Models/MediaMetadata.php`  
**Factory:** `database/factories/MediaMetadataFactory.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/MediaMetadataTest.php`) ‚úÖ

```php
‚úÖ test('uses ULID as primary key')
‚úÖ test('casts duration_ms to integer')
‚úÖ test('casts bitrate_kbps to integer')
‚úÖ test('casts frame_rate to float')
‚úÖ test('casts frame_count to integer')
‚úÖ test('belongs to media')
‚úÖ test('has no guarded attributes')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/MediaMetadataTest.php`) ‚úÖ

```php
‚úÖ test('metadata can be created with factory')
‚úÖ test('metadata belongs to media')
‚úÖ test('metadata stores av technical details')
‚úÖ test('metadata can store video codec')
‚úÖ test('metadata can store audio codec')
‚úÖ test('metadata duration_ms is cast to integer')
‚úÖ test('metadata bitrate_kbps is cast to integer')
‚úÖ test('metadata frame_rate is cast to float')
‚úÖ test('metadata frame_count is cast to integer')
‚úÖ test('metadata can have null values for optional fields')
‚úÖ test('metadata auto generates ULID on creation')
‚úÖ test('metadata supports common video codecs')
‚úÖ test('metadata supports common audio codecs')
```

---

#### 1.6. PostType ‚úÖ

**–ü—É—Ç—å:** `app/Models/PostType.php`  
**Factory:** `database/factories/PostTypeFactory.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/PostTypeTest.php`) ‚úÖ

```php
‚úÖ test('has fillable attributes')
‚úÖ test('casts options_json to PostTypeOptions')
‚úÖ test('has entries relationship')
‚úÖ test('slug is unique')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/PostTypeTest.php`) ‚úÖ

```php
‚úÖ test('post type can be created')
‚úÖ test('post type has unique slug')
‚úÖ test('post type can have multiple entries')
‚úÖ test('post type options are stored correctly')
‚úÖ test('post type options can be empty')
‚úÖ test('post type options cast works on retrieval')
‚úÖ test('post type options taxonomy check works')
‚úÖ test('post type options allows all taxonomies when list is empty')
‚úÖ test('post type options has field check works')
‚úÖ test('post type options get field with default works')
‚úÖ test('post type can be updated')
‚úÖ test('post type options can be updated')
‚úÖ test('post type slug cannot be changed to existing slug')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω cast –≤ PostTypeOptions
-   –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ –º–µ—Ç–æ–¥—ã PostTypeOptions (taxonomies, fields)
-   –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å slug

---

#### 1.7. Plugin ‚úÖ

**–ü—É—Ç—å:** `app/Models/Plugin.php`  
**Factory:** `database/factories/PluginFactory.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/PluginTest.php`) ‚úÖ

```php
‚úÖ test('uses ULID as primary key')
‚úÖ test('casts enabled to boolean')
‚úÖ test('casts meta_json to array')
‚úÖ test('casts last_synced_at to immutable_datetime')
‚úÖ test('has no guarded attributes')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/PluginTest.php`) ‚úÖ

```php
‚úÖ test('plugin can be created')
‚úÖ test('plugin can be enabled')
‚úÖ test('plugin can be disabled')
‚úÖ test('plugin stores metadata')
‚úÖ test('plugin tracks last sync time')
```

---

#### 1.8. Option ‚úÖ

**–ü—É—Ç—å:** `app/Models/Option.php`  
**Factory:** `database/factories/OptionFactory.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/OptionTest.php`) ‚úÖ

```php
‚úÖ test('uses ULID as primary key')
‚úÖ test('has fillable attributes')
‚úÖ test('casts value_json using AsJsonValue')
‚úÖ test('uses soft deletes')
‚úÖ test('table name is options')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/OptionTest.php`) ‚úÖ

```php
‚úÖ test('option can be created')
‚úÖ test('option value is stored as json')
‚úÖ test('option can be retrieved by namespace and key')
‚úÖ test('option can be soft deleted')
‚úÖ test('option can be restored after soft delete')
```

---

#### 1.9. Taxonomy ‚úÖ

**–ü—É—Ç—å:** `app/Models/Taxonomy.php`  
**Factory:** `database/factories/TaxonomyFactory.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/TaxonomyTest.php`) ‚úÖ

```php
‚úÖ test('casts options_json to array')
‚úÖ test('casts hierarchical to boolean')
‚úÖ test('has terms relationship')
‚úÖ test('label accessor returns name')
‚úÖ test('has no guarded attributes')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/TaxonomyTest.php`) ‚úÖ

```php
‚úÖ test('taxonomy can be created')
‚úÖ test('taxonomy can be hierarchical')
‚úÖ test('taxonomy can be flat')
‚úÖ test('taxonomy can have multiple terms')
‚úÖ test('taxonomy label accessor works')
‚úÖ test('taxonomy options can be stored')
```

---

#### 1.10. Term ‚úÖ

**–ü—É—Ç—å:** `app/Models/Term.php`  
**Factory:** `database/factories/TermFactory.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/TermTest.php`) ‚úÖ

```php
‚úÖ test('casts meta_json to array')
‚úÖ test('belongs to taxonomy')
‚úÖ test('has entries many to many relationship')
‚úÖ test('has ancestors relationship')
‚úÖ test('has descendants relationship')
‚úÖ test('has parent relationship')
‚úÖ test('has children relationship')
‚úÖ test('uses soft deletes')
‚úÖ test('has no guarded attributes')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/TermTest.php`) ‚úÖ

```php
‚úÖ test('term belongs to taxonomy')
‚úÖ test('term can be attached to entries')
‚úÖ test('term can be soft deleted')
‚úÖ test('term meta json stores additional data')
‚úÖ test('in taxonomy scope filters by taxonomy id')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   –¢–µ—Å—Ç—ã –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è —á–µ—Ä–µ–∑ TermTree (closure table)
-   –°–≤—è–∑–∏ —Å Entry –∏ Taxonomy –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

#### 1.11. TermTree ‚úÖ

**–ü—É—Ç—å:** `app/Models/TermTree.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/TermTreeTest.php`) ‚úÖ

```php
‚úÖ test('table name is term_tree')
‚úÖ test('does not use timestamps')
‚úÖ test('does not use incrementing')
‚úÖ test('has no guarded attributes')
‚úÖ test('has no primary key')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/TermTreeTest.php`) ‚úÖ

```php
‚úÖ test('term tree stores term relationships')
‚úÖ test('term tree implements closure table pattern')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   –†–µ–∞–ª–∏–∑—É–µ—Ç closure table –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ —Ç–µ—Ä–º–æ–≤
-   –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã—Ö —Å–≤—è–∑–µ–π (depth > 1)

---

#### 1.12. RefreshToken ‚úÖ

**–ü—É—Ç—å:** `app/Models/RefreshToken.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/RefreshTokenTest.php`) ‚úÖ

```php
‚úÖ test('has fillable attributes')
‚úÖ test('casts timestamps to datetime')
‚úÖ test('belongs to user')
‚úÖ test('is valid when not used not revoked and not expired')
‚úÖ test('is invalid when used')
‚úÖ test('is invalid when revoked')
‚úÖ test('is invalid when expired')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/RefreshTokenTest.php`) ‚úÖ

```php
‚úÖ test('refresh token can be created')
‚úÖ test('refresh token belongs to user')
‚úÖ test('refresh token can be used once')
‚úÖ test('refresh token can be revoked')
‚úÖ test('refresh token supports rotation')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –º–µ—Ç–æ–¥—ã `isValid()` –∏ `isInvalid()`
-   –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–æ—Ç–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤ —á–µ—Ä–µ–∑ `parent_jti`

---

#### 1.13. ReservedRoute ‚úÖ

**–ü—É—Ç—å:** `app/Models/ReservedRoute.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/ReservedRouteTest.php`) ‚úÖ

```php
‚úÖ test('has fillable attributes')
‚úÖ test('supports path type')
‚úÖ test('supports prefix type')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/ReservedRouteTest.php`) ‚úÖ

```php
‚úÖ test('reserved route can be created')
‚úÖ test('path type matches exact path')
‚úÖ test('prefix type matches path prefix')
```

---

#### 1.14. Redirect ‚úÖ

**–ü—É—Ç—å:** `app/Models/Redirect.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/RedirectTest.php`) ‚úÖ

```php
‚úÖ test('stores redirect rules')
‚úÖ test('supports different http status codes')
‚úÖ test('has no guarded attributes')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/RedirectTest.php`) ‚úÖ

```php
‚úÖ test('redirect can be created')
‚úÖ test('redirect supports 301 permanent redirect')
‚úÖ test('redirect supports 302 temporary redirect')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   –ú–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `from_path` / `to_path` –∏ `code` (–Ω–µ `from`/`to`/`status`)
-   –û–±–Ω–æ–≤–ª—ë–Ω PHPDoc –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ö–µ–º–µ

---

#### 1.15. Audit ‚úÖ

**–ü—É—Ç—å:** `app/Models/Audit.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/AuditTest.php`) ‚úÖ

```php
‚úÖ test('casts diff_json to array')
‚úÖ test('stores ip and user agent')
‚úÖ test('belongs to user')
‚úÖ test('tracks entity changes')
‚úÖ test('has no guarded attributes')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/AuditTest.php`) ‚úÖ

```php
‚úÖ test('audit records are created on entity changes')
‚úÖ test('audit stores diff of changes')
‚úÖ test('audit belongs to user who made change')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   –ú–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `action`/`subject_type`/`subject_id` (–Ω–µ `event`/`auditable_*`)
-   –•—Ä–∞–Ω–∏—Ç `ip` –∏ `ua` –≤–º–µ—Å—Ç–æ `meta` JSON
-   –û–±–Ω–æ–≤–ª—ë–Ω PHPDoc –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ö–µ–º–µ

---

#### 1.16. Outbox ‚úÖ

**–ü—É—Ç—å:** `app/Models/Outbox.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### Unit-—Ç–µ—Å—Ç—ã (`tests/Unit/Models/OutboxTest.php`) ‚úÖ

```php
‚úÖ test('casts payload_json to array')
‚úÖ test('casts attempts to integer')
‚úÖ test('casts available_at to datetime')
‚úÖ test('supports retry attempts')
‚úÖ test('table name is outbox')
‚úÖ test('has no guarded attributes')
```

##### Feature-—Ç–µ—Å—Ç—ã (`tests/Feature/Models/OutboxTest.php`) ‚úÖ

```php
‚úÖ test('outbox message can be created')
‚úÖ test('outbox stores payload data')
‚úÖ test('outbox tracks retry attempts')
‚úÖ test('outbox available_at controls when task is available')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   –ú–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `topic` (–Ω–µ `type`)
-   –¢–∞–±–ª–∏—Ü–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `outbox` (singular), –∞ –Ω–µ `outboxes`
-   –û–±–Ω–æ–≤–ª—ë–Ω PHPDoc –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ö–µ–º–µ

---

## 2. Domain Services (63 —Å—É—â–Ω–æ—Å—Ç–∏)

### 2.1. –ú–æ–¥—É–ª—å Auth (4 —Å—É—â–Ω–æ—Å—Ç–∏) ‚úÖ

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### 2.1.1. JwtService ‚úÖ

**–ü—É—Ç—å:** `app/Domain/Auth/JwtService.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Auth/JwtServiceTest.php`) ‚úÖ

```php
‚úÖ test('issues access token with correct claims')
‚úÖ test('issues refresh token with correct claims')
‚úÖ test('includes extra claims in token')
‚úÖ test('verifies valid access token')
‚úÖ test('verifies valid refresh token')
‚úÖ test('rejects token with wrong type')
‚úÖ test('rejects token with invalid issuer')
‚úÖ test('rejects token with invalid signature')
‚úÖ test('extracts user id from token')
‚úÖ test('extracts jti from token')
‚úÖ test('token includes correct expiration time for access token')
‚úÖ test('token includes correct expiration time for refresh token')
‚úÖ test('throws exception when secret is not configured')
‚úÖ test('verify without type check accepts any token type')
‚úÖ test('encode includes all standard jwt claims')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   15 Unit-—Ç–µ—Å—Ç–æ–≤
-   –ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ JWT (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –≤–∞–ª–∏–¥–∞—Ü–∏—è, –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ claims)
-   –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ (–Ω–µ–≤–∞–ª–∏–¥–Ω–∞—è –ø–æ–¥–ø–∏—Å—å, –∏—Å—Ç–µ—á–µ–Ω–∏–µ, –Ω–µ–≤–µ—Ä–Ω—ã–π issuer)

---

##### 2.1.2. RefreshTokenRepository ‚úÖ

**–ü—É—Ç—å:** `app/Domain/Auth/RefreshTokenRepository.php`  
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `app/Domain/Auth/RefreshTokenRepositoryImpl.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Auth/RefreshTokenRepositoryTest.php`) ‚úÖ

```php
‚úÖ test('stores refresh token')
‚úÖ test('finds refresh token by jti')
‚úÖ test('returns null when token not found')
‚úÖ test('marks token as used conditionally')
‚úÖ test('does not mark already used token')
‚úÖ test('does not mark revoked token')
‚úÖ test('does not mark expired token')
‚úÖ test('revokes refresh token')
‚úÖ test('revoke family revokes token and all descendants')
‚úÖ test('revoke family returns zero for non existent token')
‚úÖ test('deletes expired tokens')
‚úÖ test('supports token rotation with parent jti')
‚úÖ test('dto is valid when token is valid')
‚úÖ test('dto is invalid when token is used')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   14 Feature-—Ç–µ—Å—Ç–æ–≤ —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î
-   –ü—Ä–æ–≤–µ—Ä–µ–Ω –∞–ª–≥–æ—Ä–∏—Ç–º `revokeFamily` –¥–ª—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å–µ–º–µ–π—Å—Ç–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤
-   –£—Å–ª–æ–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (`markUsedConditionally`) –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç race conditions

---

##### 2.1.3. RefreshTokenDto ‚úÖ

**–ü—É—Ç—å:** `app/Domain/Auth/RefreshTokenDto.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Auth/RefreshTokenDtoTest.php`) ‚úÖ

```php
‚úÖ test('creates dto with all properties')
‚úÖ test('is valid when not used not revoked and not expired')
‚úÖ test('is invalid when used')
‚úÖ test('is invalid when revoked')
‚úÖ test('is invalid when expired')
‚úÖ test('is readonly')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   6 Unit-—Ç–µ—Å—Ç–æ–≤
-   Readonly DTO –¥–ª—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
-   –ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ `isValid()` –∏ `isInvalid()`

---

##### 2.1.4. JwtAuthenticationException ‚úÖ

**–ü—É—Ç—å:** `app/Domain/Auth/Exceptions/JwtAuthenticationException.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Auth/JwtAuthExceptionTest.php`) ‚úÖ

```php
‚úÖ test('creates exception with reason and detail')
‚úÖ test('exception message includes reason and detail')
‚úÖ test('converts to error payload with unauthorized code')
‚úÖ test('exception is instance of RuntimeException')
‚úÖ test('reason and detail are readonly')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   5 Unit-—Ç–µ—Å—Ç–æ–≤
-   –†–µ–∞–ª–∏–∑—É–µ—Ç `ErrorConvertible` –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
-   Readonly properties –¥–ª—è immutability

---

### 2.2. –ú–æ–¥—É–ª—å Media (—á–∞—Å—Ç–∏—á–Ω–æ) ‚úÖ

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π

**–°—Ç–∞—Ç—É—Å:** üîÑ –ß–∞—Å—Ç–∏—á–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### 2.2.0. MediaQuery (Value Object) ‚úÖ

**–ü—É—Ç—å:** `app/Domain/Media/MediaQuery.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Media/MediaQueryTest.php`) ‚úÖ

```php
‚úÖ test('creates media query with all parameters')
‚úÖ test('creates media query with minimal parameters')
‚úÖ test('media query is immutable value object')
‚úÖ test('deleted filter has correct enum values')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   4 —Ç–µ—Å—Ç–∞
-   Value Object –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤—ã–±–æ—Ä–∫–∏ –º–µ–¥–∏–∞
-   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç MediaDeletedFilter enum

---

##### 2.2.1. MediaStoreAction ‚è≥

**–ü—É—Ç—å:** `app/Domain/Media/Actions/MediaStoreAction.php`  
**–°—Ç–∞—Ç—É—Å:** ‚è≥ –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ (—Å–ª–æ–∂–Ω—ã–π, –º–Ω–æ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

-   MediaMetadataExtractor
-   StorageResolver
-   CollectionRulesResolver
-   MediaValidationPipeline
-   ExifManager

**Feature-—Ç–µ—Å—Ç—ã:** ‚è≥ –û—Ç–ª–æ–∂–µ–Ω–æ (—Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º –∏ –º–æ–∫–æ–≤)

---

##### 2.2.2. ListMediaAction ‚úÖ

**–ü—É—Ç—å:** `app/Domain/Media/Actions/ListMediaAction.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Media/ListMediaActionTest.php`) ‚úÖ

```php
‚úÖ test('lists media with pagination')
‚úÖ test('filters media by mime prefix')
‚úÖ test('filters media by collection')
‚úÖ test('searches media by title and original name')
‚úÖ test('excludes soft deleted media by default')
‚úÖ test('includes soft deleted media when requested')
‚úÖ test('shows only soft deleted media')
‚úÖ test('sorts media by different fields')
‚úÖ test('respects per page limit')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   9 —Ç–µ—Å—Ç–æ–≤
-   –ü–∞–≥–∏–Ω–∞—Ü–∏—è, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –ø–æ–∏—Å–∫, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
-   –ü–æ–¥–¥–µ—Ä–∂–∫–∞ soft deletes

---

##### 2.2.3. UpdateMediaMetadataAction ‚úÖ

**–ü—É—Ç—å:** `app/Domain/Media/Actions/UpdateMediaMetadataAction.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Media/UpdateMediaMetadataActionTest.php`) ‚úÖ

```php
‚úÖ test('updates media metadata')
‚úÖ test('updates only title')
‚úÖ test('updates only alt text')
‚úÖ test('updates only collection')
‚úÖ test('can update soft deleted media')
‚úÖ test('throws exception for non existent media')
‚úÖ test('clears metadata when set to null')
‚úÖ test('returns fresh model instance')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   8 —Ç–µ—Å—Ç–æ–≤
-   –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö: title, alt, collection
-   –ü–æ–¥–¥–µ—Ä–∂–∫–∞ soft deleted –∑–∞–ø–∏—Å–µ–π
-   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç fresh instance

---

##### 2.2.4. ExifManager

**–ü—É—Ç—å:** `app/Domain/Media/Services/ExifManager.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Services/ExifManagerTest.php`)

```php
- test('extracts exif data from image')
- test('auto rotates image based on exif orientation')
- test('strips exif data from image')
- test('filters exif fields by whitelist')
- test('extracts color profile from image')
- test('handles images without exif')
```

---

##### 2.2.5. MediaValidationPipeline

**–ü—É—Ç—å:** `app/Domain/Media/Validation/MediaValidationPipeline.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Validation/MediaValidationPipelineTest.php`)

```php
- test('runs all validators')
- test('passes valid file')
- test('rejects invalid file')
- test('stops on first error')
- test('collects all errors')
```

---

##### 2.2.6. CorruptionValidator

**–ü—É—Ç—å:** `app/Domain/Media/Validation/CorruptionValidator.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Validation/CorruptionValidatorTest.php`)

```php
- test('validates image file integrity')
- test('validates video file integrity')
- test('rejects corrupted image')
- test('rejects corrupted video')
- test('supports jpg, png, gif formats')
```

---

##### 2.2.7. MimeSignatureValidator

**–ü—É—Ç—å:** `app/Domain/Media/Validation/MimeSignatureValidator.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Validation/MimeSignatureValidatorTest.php`)

```php
- test('validates file signature matches extension')
- test('rejects file with mismatched signature')
- test('detects fake file extensions')
```

---

##### 2.2.8. SizeLimitValidator

**–ü—É—Ç—å:** `app/Domain/Media/Validation/SizeLimitValidator.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Media/Validation/SizeLimitValidatorTest.php`)

```php
- test('validates file size within limit')
- test('rejects file exceeding size limit')
- test('applies collection specific size limit')
```

---

##### 2.2.9. GdImageProcessor

**–ü—É—Ç—å:** `app/Domain/Media/Images/GdImageProcessor.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Images/GdImageProcessorTest.php`)

```php
- test('opens image file')
- test('gets image width')
- test('gets image height')
- test('resizes image')
- test('encodes image to format')
- test('supports jpg, png, gif, webp')
- test('maintains aspect ratio on resize')
```

---

##### 2.2.10. GlideImageProcessor

**–ü—É—Ç—å:** `app/Domain/Media/Images/GlideImageProcessor.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Images/GlideImageProcessorTest.php`)

```php
- test('opens image with glide')
- test('resizes image with glide')
- test('applies filters')
- test('generates thumbnails')
- test('supports more formats than GD')
```

---

##### 2.2.11. MediaMetadataExtractor

**–ü—É—Ç—å:** `app/Domain/Media/Services/MediaMetadataExtractor.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Media/Services/MediaMetadataExtractorTest.php`)

```php
- test('extracts metadata using available plugins')
- test('tries plugins in order')
- test('returns null if no plugin supports file')
- test('handles plugin errors gracefully')
```

---

##### 2.2.12. ExiftoolMediaMetadataPlugin

**–ü—É—Ç—å:** `app/Domain/Media/Services/ExiftoolMediaMetadataPlugin.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Services/ExiftoolMediaMetadataPluginTest.php`)

```php
- test('supports images')
- test('extracts metadata using exiftool')
- test('parses exiftool json output')
- test('handles exiftool errors')
- test('requires exiftool binary')
```

---

##### 2.2.13. FfprobeMediaMetadataPlugin

**–ü—É—Ç—å:** `app/Domain/Media/Services/FfprobeMediaMetadataPlugin.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Services/FfprobeMediaMetadataPluginTest.php`)

```php
- test('supports video and audio')
- test('extracts duration from video')
- test('extracts bitrate from video')
- test('extracts frame rate from video')
- test('extracts codec information')
- test('requires ffprobe binary')
```

---

##### 2.2.14. MediainfoMediaMetadataPlugin

**–ü—É—Ç—å:** `app/Domain/Media/Services/MediainfoMediaMetadataPlugin.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Services/MediainfoMediaMetadataPluginTest.php`)

```php
- test('supports video and audio')
- test('extracts detailed av metadata')
- test('requires mediainfo binary')
```

---

##### 2.2.15. StorageResolver

**–ü—É—Ç—å:** `app/Domain/Media/Services/StorageResolver.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Media/Services/StorageResolverTest.php`)

```php
- test('resolves storage disk by collection')
- test('returns default disk for unknown collection')
- test('supports s3, local, public disks')
```

---

##### 2.2.16. CollectionRulesResolver

**–ü—É—Ç—å:** `app/Domain/Media/Services/CollectionRulesResolver.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Services/CollectionRulesResolverTest.php`)

```php
- test('gets rules for collection')
- test('returns global rules if collection not configured')
- test('gets allowed mimes for collection')
- test('gets max size for collection')
```

---

##### 2.2.17. OnDemandVariantService

**–ü—É—Ç—å:** `app/Domain/Media/Services/OnDemandVariantService.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Services/OnDemandVariantServiceTest.php`)

```php
- test('generates variant on demand')
- test('caches generated variant')
- test('returns existing variant if available')
- test('dispatches variant generation job')
```

---

##### 2.2.18. EloquentMediaRepository

**–ü—É—Ç—å:** `app/Domain/Media/EloquentMediaRepository.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/EloquentMediaRepositoryTest.php`)

```php
- test('builds query with filters')
- test('paginates results')
- test('gets all results')
- test('filters by deleted')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Media/MediaRepositoryTest.php`)

```php
- test('repository filters media correctly')
- test('repository includes trashed when requested')
- test('repository paginates results')
```

---

##### 2.2.19. MediaQuery

**–ü—É—Ç—å:** `app/Domain/Media/MediaQuery.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/MediaQueryTest.php`)

```php
- test('builds query from request')
- test('applies filters')
- test('applies search')
- test('applies sorting')
```

---

##### 2.2.20. MediaDeletedFilter

**–ü—É—Ç—å:** `app/Domain/Media/MediaDeletedFilter.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/MediaDeletedFilterTest.php`)

```php
- test('filters only deleted')
- test('filters only not deleted')
- test('filters all including deleted')
```

---

##### 2.2.21. MediaVariantStatus (Enum)

**–ü—É—Ç—å:** `app/Domain/Media/MediaVariantStatus.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/MediaVariantStatusTest.php`)

```php
- test('has pending status')
- test('has processing status')
- test('has completed status')
- test('has failed status')
- test('can be cast to string')
```

---

##### 2.2.22. MediaMetadataDTO

**–ü—É—Ç—å:** `app/Domain/Media/DTO/MediaMetadataDTO.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/DTO/MediaMetadataDTOTest.php`)

```php
- test('creates dto with all properties')
- test('converts to array')
- test('validates required fields')
```

---

##### 2.2.23. Events: MediaUploaded, MediaProcessed, MediaDeleted

**–ü—É—Ç—å:** `app/Domain/Media/Events/`

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Media/MediaEventsTest.php`)

```php
- test('media uploaded event is dispatched on upload')
- test('media processed event is dispatched after processing')
- test('media deleted event is dispatched on deletion')
- test('event listeners are triggered correctly')
```

---

##### 2.2.24. Listeners: LogMediaEvent, NotifyMediaEvent, PurgeCdnCache

**–ü—É—Ç—å:** `app/Domain/Media/Listeners/`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Listeners/*Test.php`)

```php
// LogMediaEvent
- test('logs media event to file')
- test('includes event details in log')

// NotifyMediaEvent
- test('sends notification on media event')
- test('notifies correct users')

// PurgeCdnCache
- test('purges cdn cache on media change')
- test('sends correct purge request')
```

---

##### 2.2.25. GenerateVariantJob

**–ü—É—Ç—å:** `app/Domain/Media/Jobs/GenerateVariantJob.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Media/Jobs/GenerateVariantJobTest.php`)

```php
- test('job generates variant')
- test('job updates variant status to processing')
- test('job updates variant status to completed on success')
- test('job updates variant status to failed on error')
- test('job stores generated file')
- test('job can be retried on failure')
```

---

### 2.3. –ú–æ–¥—É–ª—å Entries (1 —Å—É—â–Ω–æ—Å—Ç—å) ‚úÖ

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥ –í—ã—Å–æ–∫–∏–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### 2.3.1. PublishingService ‚úÖ

**–ü—É—Ç—å:** `app/Domain/Entries/PublishingService.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Entries/PublishingServiceTest.php`) ‚úÖ

```php
‚úÖ test('publishes entry immediately with auto published_at')
‚úÖ test('schedules entry with provided published_at')
‚úÖ test('validates published_at is not in future')
‚úÖ test('changes entry status to published with auto date')
‚úÖ test('overwrites published_at when transitioning draft to published without explicit date')
‚úÖ test('keeps draft status without published_at')
‚úÖ test('allows updating published entry without changing published_at')
‚úÖ test('sets published_at when creating published entry')
‚úÖ test('transitions from draft to published sets published_at')
‚úÖ test('validates published_at when explicitly provided')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Entries/PublishingServiceTest.php`) ‚úÖ

```php
‚úÖ test('entry can be published')
‚úÖ test('entry can be scheduled for publishing in past')
‚úÖ test('cannot publish with future date')
‚úÖ test('entry can be unpublished')
‚úÖ test('multiple entries can be published')
‚úÖ test('published_at uses UTC timezone')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   16 —Ç–µ—Å—Ç–æ–≤ (10 Unit + 6 Feature)
-   –ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –ª–æ–≥–∏–∫–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–µ–π
-   –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (–¥–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–µ –≤ –±—É–¥—É—â–µ–º)
-   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ `published_at` –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

---

### 2.4. –ú–æ–¥—É–ª—å Plugins (—á–∞—Å—Ç–∏—á–Ω–æ) ‚úÖ

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü° –°—Ä–µ–¥–Ω–∏–π

**–°—Ç–∞—Ç—É—Å:** üîÑ –ß–∞—Å—Ç–∏—á–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### 2.4.1. PluginActivator ‚è≥

**–ü—É—Ç—å:** `app/Domain/Plugins/PluginActivator.php`  
**–°—Ç–∞—Ç—É—Å:** ‚è≥ –¢—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** `PluginsRouteReloader` –æ–±—ä—è–≤–ª–µ–Ω –∫–∞–∫ `final`, —á—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ç–µ—Å—Ç–∞—Ö. –¢—Ä–µ–±—É–µ—Ç—Å—è:

-   –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è `PluginsRouteReloader`
-   –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Dependency Injection —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º

**–¢–µ—Å—Ç—ã:** –û—Ç–ª–æ–∂–µ–Ω–æ –¥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

---

##### 2.4.2. PluginRegistry ‚úÖ

**–ü—É—Ç—å:** `app/Domain/Plugins/PluginRegistry.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Plugins/PluginRegistryTest.php`) ‚úÖ

```php
‚úÖ test('returns enabled plugins only')
‚úÖ test('returns empty collection when no plugins enabled')
‚úÖ test('orders plugins by slug')
‚úÖ test('returns enabled providers')
‚úÖ test('filters out empty provider names')
‚úÖ test('returns empty array when no enabled plugins')
‚úÖ test('handles mixed provider types')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   7 —Ç–µ—Å—Ç–æ–≤
-   –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–º –≤–∫–ª—é—á—ë–Ω–Ω—ã—Ö –ø–ª–∞–≥–∏–Ω–æ–≤
-   –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
-   –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ç–∞–±–ª–∏—Ü—ã (–º–∏–≥—Ä–∞—Ü–∏–∏)

---

##### 2.4.3. PluginsSynchronizer

**–ü—É—Ç—å:** `app/Domain/Plugins/Services/PluginsSynchronizer.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Plugins/Services/PluginsSynchronizerTest.php`)

```php
- test('syncs plugins from filesystem')
- test('creates new plugin records')
- test('updates existing plugin records')
- test('validates plugin manifests')
- test('dispatches plugins synced event')
```

---

##### 2.4.4. PluginsRouteReloader

**–ü—É—Ç—å:** `app/Domain/Plugins/Services/PluginsRouteReloader.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Plugins/Services/PluginsRouteReloaderTest.php`)

```php
- test('reloads plugin routes')
- test('clears route cache')
- test('loads routes from enabled plugins')
- test('throws exception on reload failure')
```

---

##### 2.4.5. PluginAutoloader

**–ü—É—Ç—å:** `app/Domain/Plugins/Services/PluginAutoloader.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Plugins/Services/PluginAutoloaderTest.php`)

```php
- test('registers plugin autoloader')
- test('loads plugin classes')
- test('handles plugin namespace')
```

---

##### 2.4.6. PluginsSyncCommand

**–ü—É—Ç—å:** `app/Domain/Plugins/Commands/PluginsSyncCommand.php`

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Plugins/PluginsSyncCommandTest.php`)

```php
- test('command syncs plugins')
- test('command output shows sync results')
```

---

##### 2.4.7. Plugin Events & Exceptions

**–ü—É—Ç—å:** `app/Domain/Plugins/Events/`, `app/Domain/Plugins/Exceptions/`

**Unit-—Ç–µ—Å—Ç—ã**

```php
// Events
- test('plugin enabled event is dispatched')
- test('plugin disabled event is dispatched')
- test('plugins synced event is dispatched')
- test('plugins routes reloaded event is dispatched')

// Exceptions
- test('invalid plugin manifest exception')
- test('plugin already enabled exception')
- test('plugin already disabled exception')
- test('routes reload failed exception')
```

---

### 2.5. –ú–æ–¥—É–ª—å Routing (—á–∞—Å—Ç–∏—á–Ω–æ) ‚úÖ

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü° –°—Ä–µ–¥–Ω–∏–π

**–°—Ç–∞—Ç—É—Å:** üîÑ –ß–∞—Å—Ç–∏—á–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### 2.5.1. PathReservationService ‚è≥

**–ü—É—Ç—å:** `app/Domain/Routing/PathReservationServiceImpl.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Routing/PathReservationServiceTest.php`)

```php
- test('reserves path')
- test('releases path')
- test('checks if path is reserved')
- test('throws exception on duplicate reservation')
- test('validates path format')
- test('normalizes path before reservation')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Routing/PathReservationTest.php`)

```php
- test('path can be reserved')
- test('reserved path cannot be used by entry')
- test('path can be released')
- test('released path can be reused')
- test('system paths are automatically reserved')
- test('plugin paths are reserved on activation')
```

---

##### 2.5.2. PathReservationStore

**–ü—É—Ç—å:** `app/Domain/Routing/PathReservationStoreImpl.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Routing/PathReservationStoreTest.php`)

```php
- test('stores path reservation')
- test('retrieves path reservation')
- test('removes path reservation')
- test('checks if path exists')
```

---

##### 2.5.3. PathNormalizer ‚úÖ

**–ü—É—Ç—å:** `app/Domain/Routing/PathNormalizer.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Routing/PathNormalizerTest.php`) ‚úÖ

```php
‚úÖ test('normalizes path with leading slash')
‚úÖ test('normalizes path without trailing slash')
‚úÖ test('normalizes multiple slashes')
‚úÖ test('converts to lowercase')
‚úÖ test('handles unicode characters')
‚úÖ test('removes query string')
‚úÖ test('removes fragment')
‚úÖ test('removes query and fragment')
‚úÖ test('removes relative path segments')
‚úÖ test('trims whitespace')
‚úÖ test('handles root path')
‚úÖ test('throws exception for empty path')
‚è≠Ô∏è test('throws exception for only query string') - skipped
‚úÖ test('throws exception for only fragment')
‚úÖ test('normalizes complex path')
‚úÖ test('applies unicode NFC normalization if available')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   16 —Ç–µ—Å—Ç–æ–≤ (15 passed, 1 skipped)
-   –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Ç–µ–π: lowercase, trim slashes, remove query/fragment
-   Unicode NFC –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è

---

##### 2.5.4. ReservedRouteRegistry

**–ü—É—Ç—å:** `app/Domain/Routing/ReservedRouteRegistry.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Routing/ReservedRouteRegistryTest.php`)

```php
- test('registers reserved route')
- test('gets all reserved routes')
- test('checks if path is in registry')
```

---

##### 2.5.5. ReservedPattern ‚úÖ

**–ü—É—Ç—å:** `app/Domain/Routing/ReservedPattern.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Routing/ReservedPatternTest.php`) ‚úÖ

```php
‚úÖ test('generates slug regex pattern')
‚úÖ test('slug regex matches valid slug')
‚úÖ test('slug regex rejects invalid characters')
‚úÖ test('slug regex rejects trailing dash')
‚úÖ test('slug regex rejects leading dash')
‚úÖ test('slug regex allows dash in middle')
‚úÖ test('slug regex rejects uppercase')
‚úÖ test('slug regex rejects empty string')
‚úÖ test('slug regex may include negative lookahead for reserved paths')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   9 —Ç–µ—Å—Ç–æ–≤
-   –ì–µ–Ω–µ—Ä–∞—Ü–∏—è regex –¥–ª—è slug —Å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—É—Ç–µ–π
-   –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ slug: lowercase, a-z0-9-

---

##### 2.5.6. Routing Exceptions ‚úÖ

**–ü—É—Ç—å:** `app/Domain/Routing/Exceptions/`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Unit-—Ç–µ—Å—Ç—ã** ‚úÖ

**InvalidPathException** (`tests/Unit/Routing/InvalidPathExceptionTest.php`):

```php
‚úÖ test('creates exception with message')
‚úÖ test('creates exception with default message')
‚úÖ test('exception is instance of Exception')
‚úÖ test('converts to error payload with validation error code')
```

**PathAlreadyReservedException** (`tests/Unit/Routing/PathAlreadyReservedExceptionTest.php`):

```php
‚úÖ test('creates exception with path and owner')
‚úÖ test('creates exception with custom message')
‚úÖ test('readonly properties cannot be modified')
‚úÖ test('converts to error payload with conflict code')
```

**ForbiddenReservationRelease** (`tests/Unit/Routing/ForbiddenReservationReleaseTest.php`):

```php
‚úÖ test('creates exception with path owner and attempted source')
‚úÖ test('creates exception with custom message')
‚úÖ test('readonly properties cannot be modified')
‚úÖ test('converts to error payload with forbidden code')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   12 —Ç–µ—Å—Ç–æ–≤ (4 + 4 + 4)
-   –í—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑—É—é—Ç `ErrorConvertible`
-   Readonly properties –¥–ª—è immutability

---

### 2.6. –ú–æ–¥—É–ª—å Search (9 —Å—É—â–Ω–æ—Å—Ç–µ–π)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü° –°—Ä–µ–¥–Ω–∏–π

##### 2.6.1. SearchService

**–ü—É—Ç—å:** `app/Domain/Search/SearchService.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Search/SearchServiceTest.php`)

```php
- test('searches entries')
- test('applies filters to search')
- test('applies sorting to results')
- test('paginates search results')
- test('returns search result object')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Search/SearchQueryTest.php`)

```php
- test('search returns relevant entries')
- test('search filters by post type')
- test('search filters by date range')
- test('search filters by terms')
- test('search highlights matched text')
```

---

##### 2.6.2. IndexManager

**–ü—É—Ç—å:** `app/Domain/Search/IndexManager.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Search/IndexManagerTest.php`)

```php
- test('creates search index')
- test('deletes search index')
- test('updates index mappings')
- test('reindexes all entries')
- test('indexes single entry')
- test('removes entry from index')
- test('swaps index alias')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Search/SearchIndexingTest.php`)

```php
- test('new entry is indexed automatically')
- test('updated entry is reindexed')
- test('deleted entry is removed from index')
- test('full reindex updates all entries')
- test('zero-downtime reindexing with alias swap')
```

---

##### 2.6.3. ElasticsearchSearchClient

**–ü—É—Ç—å:** `app/Domain/Search/Clients/ElasticsearchSearchClient.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Search/Clients/ElasticsearchSearchClientTest.php`)

```php
- test('sends search request to elasticsearch')
- test('creates index via api')
- test('deletes index via api')
- test('updates aliases via api')
- test('gets indices for alias')
- test('performs bulk operations')
- test('refreshes index')
- test('handles http errors')
- test('supports basic auth')
```

---

##### 2.6.4. NullSearchClient

**–ü—É—Ç—å:** `app/Domain/Search/Clients/NullSearchClient.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Search/Clients/NullSearchClientTest.php`)

```php
- test('returns empty results')
- test('does nothing on index operations')
```

---

##### 2.6.5. EntryToSearchDoc

**–ü—É—Ç—å:** `app/Domain/Search/Transformers/EntryToSearchDoc.php`

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/Domain/Search/Transformers/EntryToSearchDocTest.php`)

```php
- test('transforms entry to search document')
- test('extracts text from data_json')
- test('normalizes whitespace in content')
- test('generates excerpt from content')
- test('includes entry metadata')
- test('includes post type information')
- test('includes terms information')
```

---

##### 2.6.6. SearchQuery, SearchResult, SearchHit

**–ü—É—Ç—å:** `app/Domain/Search/`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Search/SearchQueryTest.php`, etc.)

```php
// SearchQuery
- test('builds query from parameters')
- test('adds filters to query')
- test('adds sorting to query')
- test('sets pagination')

// SearchResult
- test('contains hits')
- test('contains total count')
- test('contains aggregations')

// SearchHit
- test('wraps search result item')
- test('provides score')
- test('provides highlights')
```

---

##### 2.6.7. SearchTermFilter

**–ü—É—Ç—å:** `app/Domain/Search/ValueObjects/SearchTermFilter.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Search/ValueObjects/SearchTermFilterTest.php`)

```php
- test('creates filter from term id')
- test('converts to elasticsearch filter')
```

---

##### 2.6.8. ReindexSearchJob

**–ü—É—Ç—å:** `app/Domain/Search/Jobs/ReindexSearchJob.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Domain/Search/Jobs/ReindexSearchJobTest.php`)

```php
- test('job reindexes all entries')
- test('job handles large datasets')
- test('job can be retried on failure')
```

---

##### 2.6.9. SearchReindexCommand

**–ü—É—Ç—å:** `app/Domain/Search/Commands/SearchReindexCommand.php`

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Domain/Search/SearchReindexCommandTest.php`)

```php
- test('command triggers reindex')
- test('command shows progress')
- test('command dispatches reindex job')
```

---

### 2.7. –ú–æ–¥—É–ª—å View ‚úÖ

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü¢ –ù–∏–∑–∫–∏–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### 2.7.1. BladeTemplateResolver ‚úÖ

**–ü—É—Ç—å:** `app/Domain/View/BladeTemplateResolver.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/View/BladeTemplateResolverTest.php`) ‚úÖ

```php
‚úÖ test('returns default template when no specific templates exist')
‚úÖ test('uses template override when specified')
‚úÖ test('throws exception when template override does not exist')
‚úÖ test('uses post type specific template when it exists')
‚úÖ test('uses entry specific template when it exists')
‚úÖ test('template override has highest priority')
‚úÖ test('entry specific template has priority over post type template')
‚úÖ test('can use custom default template')
‚úÖ test('handles entry with loaded post type relationship')
‚úÖ test('handles entry without post type slug')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   10 —Ç–µ—Å—Ç–æ–≤
-   –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —à–∞–±–ª–æ–Ω–æ–≤: override > entry--{type}--{slug} > entry--{type} > default
-   –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Blade View facade
-   –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å eager loading

---

### 2.8. –ú–æ–¥—É–ª—å Sanitizer ‚úÖ

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü° –°—Ä–µ–¥–Ω–∏–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### 2.8.1. RichTextSanitizer ‚úÖ

**–ü—É—Ç—å:** `app/Domain/Sanitizer/RichTextSanitizer.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Sanitizer/RichTextSanitizerTest.php`) ‚úÖ

```php
‚úÖ test('sanitizes basic html content')
‚úÖ test('removes script tags')
‚úÖ test('removes inline javascript')
‚úÖ test('removes dangerous iframe tags')
‚úÖ test('allows safe formatting tags')
‚úÖ test('adds noopener noreferrer to target blank links')
‚úÖ test('preserves existing rel attributes and adds noopener noreferrer')
‚úÖ test('does not add rel to links without target blank')
‚úÖ test('handles malformed html')
‚úÖ test('removes javascript protocol from links')
‚úÖ test('removes onerror from images')
‚úÖ test('preserves nested formatting')
‚úÖ test('handles empty content')
‚úÖ test('handles plain text without tags')
‚úÖ test('removes style attributes with dangerous content')
‚úÖ test('sanitizes lists and preserves structure')
‚úÖ test('handles multiple target blank links')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   17 —Ç–µ—Å—Ç–æ–≤
-   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç HTMLPurifier –¥–ª—è –æ—á–∏—Å—Ç–∫–∏
-   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ rel="noopener noreferrer"
-   –ó–∞—â–∏—Ç–∞ –æ—Ç XSS –∞—Ç–∞–∫ (script, onclick, javascript:, etc.)

---

### 2.9. –ú–æ–¥—É–ª—å Options ‚úÖ

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü¢ –ù–∏–∑–∫–∏–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### 2.9.1. OptionsRepository ‚úÖ

**–ü—É—Ç—å:** `app/Domain/Options/OptionsRepository.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Options/OptionsRepositoryTest.php`) ‚úÖ

```php
‚úÖ test('option can be created and retrieved')
‚úÖ test('option can be updated')
‚úÖ test('option can be deleted')
‚úÖ test('options are scoped by namespace')
‚úÖ test('returns default value when option not found')
‚úÖ test('stores complex json values')
‚úÖ test('soft deleted option returns default value')
‚úÖ test('can restore soft deleted option')
‚úÖ test('restore returns null for non existent option')
‚úÖ test('delete returns false for non existent option')
‚úÖ test('dispatches option changed event on set')
‚úÖ test('can update with description')
‚úÖ test('set restores soft deleted option')
‚úÖ test('getInt returns integer value')
‚úÖ test('getInt returns default when option not found')
‚úÖ test('getInt casts string to int')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   16 —Ç–µ—Å—Ç–æ–≤
-   –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ç–µ–≥–∞–º–∏ (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥—Ä–∞–π–≤–µ—Ä–æ–º)
-   Soft deletes –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
-   –°–æ–±—ã—Ç–∏—è OptionChanged
-   –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

---

### 2.10. –ú–æ–¥—É–ª—å PostTypes ‚úÖ

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü¢ –ù–∏–∑–∫–∏–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

##### 2.10.1. PostTypeOptions ‚úÖ

**–ü—É—Ç—å:** `app/Domain/PostTypes/PostTypeOptions.php`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Unit-—Ç–µ—Å—Ç—ã** (`tests/Unit/PostTypes/PostTypeOptionsTest.php`) ‚úÖ

```php
‚úÖ test('creates options from array')
‚úÖ test('creates empty options')
‚úÖ test('converts options to array')
‚úÖ test('normalizes string taxonomies to integers')
‚úÖ test('accepts mixed integer and string taxonomies')
‚úÖ test('throws exception for invalid taxonomies')
‚úÖ test('throws exception for negative taxonomy ids')
‚úÖ test('throws exception for zero taxonomy id')
‚úÖ test('throws exception when taxonomies is not a list')
‚úÖ test('gets allowed taxonomies')
‚úÖ test('checks if taxonomy is allowed')
‚úÖ test('allows all taxonomies when list is empty')
‚úÖ test('gets field value')
‚úÖ test('returns default for non existent field')
‚úÖ test('checks if field exists')
‚úÖ test('is immutable value object')
‚úÖ test('converts to api array with normalized structure')
‚úÖ test('preserves taxonomies as array in api response')
‚úÖ test('handles complex nested structures')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   19 —Ç–µ—Å—Ç–æ–≤
-   Value Object –¥–ª—è –æ–ø—Ü–∏–π PostType
-   –í–∞–ª–∏–¥–∞—Ü–∏—è taxonomies (—Ç–æ–ª—å–∫–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–ª—ã–µ)
-   –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–æ–∫ –≤ int
-   Immutability (readonly properties)
-   API-friendly —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è

---

## 3. HTTP Controllers (60 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤)

### 3.1. Auth API (4 —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞) ‚úÖ

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Auth/LoginTest.php`, `CurrentUserTest.php`, `RefreshTest.php`, `LogoutTest.php`) ‚úÖ

```php
// POST /api/v1/auth/login (LoginTest.php) - 12 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('successful login returns tokens')
‚úÖ test('login with invalid credentials returns 401')
‚úÖ test('login with missing email returns validation error')
‚úÖ test('login with missing password returns validation error')
‚úÖ test('login creates audit log on success')
‚úÖ test('login creates audit log on failure')
‚úÖ test('login with invalid email format returns validation error')
‚úÖ test('login is case insensitive for email')
‚úÖ test('login sets httponly secure cookies')
‚úÖ test('login issues refresh token and stores in database')
‚úÖ test('refresh token has correct parent relationship')
‚úÖ test('multiple logins create separate refresh tokens')

// GET /api/v1/admin/auth/current (CurrentUserTest.php) - 6 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('authenticated user can get current user info')
‚úÖ test('unauthenticated request returns 401')
‚úÖ test('returns correct user data structure')
‚úÖ test('does not expose sensitive fields')
‚úÖ test('works with admin user')
‚úÖ test('works with regular user')

// POST /api/v1/auth/refresh (RefreshTest.php) - 4 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('refresh without cookie returns 401')
‚úÖ test('refresh with invalid token returns 401')
‚úÖ test('refresh endpoint exists and requires authentication')
‚úÖ test('refresh endpoint clears cookies on error')

// POST /api/v1/auth/logout (LogoutTest.php) - 9 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('authenticated user can logout')
‚úÖ test('logout clears access and refresh cookies')
‚úÖ test('logout without authentication returns 401')
‚úÖ test('logout revokes current refresh token')
‚úÖ test('logout with all parameter revokes all user tokens')
‚úÖ test('logout without all parameter revokes only current token family')
‚úÖ test('logout handles missing refresh token gracefully')
‚úÖ test('logout handles invalid refresh token gracefully')
‚úÖ test('logout is idempotent')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   31 Feature —Ç–µ—Å—Ç (12+6+4+9)
-   –ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ Auth API
-   JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ refresh token rotation –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
-   `UserResource` –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è `is_admin`, `created_at`, `updated_at`
-   JWT middleware –æ—Ç–∫–ª—é—á–µ–Ω –≤ —Ç–µ—Å—Ç–∞—Ö (—É–∂–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –æ—Ç–¥–µ–ª—å–Ω–æ)
-   –ü–æ–ª–Ω–æ–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ refresh-–º–µ—Ö–∞–Ω–∏–∑–º–∞ (—Ä–æ—Ç–∞—Ü–∏—è, reuse attack) –≤ `LoginTest`

---

### 3.2. Entries API

#### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (53 —Ç–µ—Å—Ç–∞, 161 assertions)

// GET /api/v1/admin/entries (ListEntriesTest.php) - 12 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can list entries')
‚úÖ test('entries are paginated')
‚úÖ test('entries can be filtered by post type')
‚úÖ test('entries can be filtered by status')
‚úÖ test('entries can be searched by title')
‚úÖ test('entries can be searched by slug')
‚úÖ test('unauthenticated request returns 401')
‚úÖ test('entries can be filtered by author')
‚úÖ test('entries can be sorted by updated_at')
‚úÖ test('entries can be sorted by title')
‚úÖ test('trashed entries are excluded by default')
‚úÖ test('trashed entries can be listed with filter')

// POST /api/v1/admin/entries (CreateEntryTest.php) - 13 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can create entry')
‚úÖ test('entry is created with correct author')
‚úÖ test('entry slug is auto-generated from title')
‚úÖ test('entry can be created with custom slug')
‚úÖ test('entry is created as draft by default')
‚úÖ test('entry can be published immediately')
‚úÖ test('entry can be created with content_json')
‚úÖ test('entry can be created with meta_json')
‚úÖ test('entry validation fails with missing title')
‚úÖ test('entry validation fails with missing post_type')
‚úÖ test('entry validation fails with invalid post_type')
‚úÖ test('entry can be created with template_override')
‚úÖ test('duplicate slug is made unique')

// GET /api/v1/admin/entries/{id} (ShowEntryTest.php) - 8 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can view entry')
‚úÖ test('entry includes author relationship')
‚úÖ test('entry includes post type relationship')
‚úÖ test('not found returns 404')
‚úÖ test('can view soft deleted entry')
‚úÖ test('entry includes content_json')
‚úÖ test('entry includes meta_json')
‚úÖ test('entry includes timestamps')

// PUT /api/v1/admin/entries/{id} (UpdateEntryTest.php) - 11 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can update entry')
‚úÖ test('entry data is updated correctly')
‚úÖ test('entry validation works on update')
‚úÖ test('not found returns 404')
‚úÖ test('can update content_json')
‚úÖ test('can update meta_json')
‚úÖ test('can publish draft entry')
‚úÖ test('can unpublish entry')
‚úÖ test('can update template_override')
‚úÖ test('can update soft deleted entry')
‚úÖ test('updated_at changes after update')

// DELETE /api/v1/admin/entries/{id} + POST /api/v1/admin/entries/{id}/restore (DeleteRestoreEntryTest.php) - 9 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can soft delete entry')
‚úÖ test('deleted entry is not in default list')
‚úÖ test('delete not found returns 404')
‚úÖ test('cannot delete already deleted entry')
‚úÖ test('admin can restore deleted entry')
‚úÖ test('restored entry appears in default list')
‚úÖ test('restore not found returns 404')
‚úÖ test('cannot restore non-deleted entry')
‚úÖ test('restored entry retains all data')

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   53 Feature —Ç–µ—Å—Ç–∞ –ø–æ–∫—Ä—ã–≤–∞—é—Ç –±–∞–∑–æ–≤—ã–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–µ–π
-   –¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –ø–æ–∏—Å–∫, –ø–∞–≥–∏–Ω–∞—Ü–∏—è, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
-   –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞ —Å relationships (author, postType, terms)
-   –¢–µ—Å—Ç–∏—Ä—É—é—Ç—Å—è –º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
-   –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è auto-slug generation –∏ uniqueness
-   Middleware `JwtAuth` –∏ `VerifyApiCsrf` –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ —Ç–µ—Å—Ç–∞—Ö
-   Endpoints –¥–ª—è `/statuses`, `/terms`, `/terms/sync` - –ø–æ–∫–∞ –Ω–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

### 3.3. Media API

#### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (35 —Ç–µ—Å—Ç–æ–≤, 123 assertions)

// GET /api/v1/admin/media (ListMediaTest.php) - 13 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can list media')
‚úÖ test('media are paginated')
‚úÖ test('media can be filtered by mime type')
‚úÖ test('media can be filtered by collection')
‚úÖ test('media can be searched by title')
‚úÖ test('media can be searched by original name')
‚úÖ test('media can be sorted by size')
‚úÖ test('media can be sorted by created_at')
‚úÖ test('trashed media are excluded by default')
‚úÖ test('trashed media can be included with filter')
‚úÖ test('only trashed media can be shown')
‚úÖ test('media response includes preview and download urls')
‚úÖ test('unauthenticated request returns 401')

// GET /api/v1/admin/media/{id} (ShowMediaTest.php) - 8 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can view media')
‚úÖ test('media includes dimensions for images')
‚úÖ test('media includes duration for videos')
‚úÖ test('not found returns 404')
‚úÖ test('can view soft deleted media')
‚úÖ test('media includes all metadata')
‚úÖ test('media includes timestamps')
‚úÖ test('media includes preview and download urls')

// PUT /api/v1/admin/media/{id} (UpdateMediaTest.php) - 7 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can update media metadata')
‚úÖ test('title can be updated')
‚úÖ test('alt text can be updated')
‚úÖ test('collection can be updated')
‚úÖ test('can update soft deleted media')
‚úÖ test('updated_at changes after update')
‚úÖ test('can update multiple fields at once')

// DELETE /api/v1/admin/media/{id} + POST /api/v1/admin/media/{id}/restore (DeleteRestoreMediaTest.php) - 7 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can soft delete media')
‚úÖ test('deleted media not in default list')
‚úÖ test('cannot delete already deleted media')
‚úÖ test('admin can restore deleted media')
‚úÖ test('restored media appears in default list')
‚úÖ test('cannot restore non-deleted media')
‚úÖ test('restored media retains all metadata')

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   35 Feature —Ç–µ—Å—Ç–æ–≤ –ø–æ–∫—Ä—ã–≤–∞—é—Ç –±–∞–∑–æ–≤—ã–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
-   –¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ mime, collection, –ø–æ–∏—Å–∫ –ø–æ title –∏ original_name
-   –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ size –∏ created_at
-   –¢–µ—Å—Ç–∏—Ä—É—é—Ç—Å—è –º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
-   –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞ —Å soft-deleted –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞–º–∏
-   Middleware `JwtAuth` –∏ `VerifyApiCsrf` –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ —Ç–µ—Å—Ç–∞—Ö
-   **POST /media (upload)** - –Ω–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω (—Ç—Ä–µ–±—É–µ—Ç —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ –∏ storage)
-   Endpoints `/preview`, `/download`, `/variants` - –ø–æ–∫–∞ –Ω–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

### 3.4. PostTypes API

#### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (17 —Ç–µ—Å—Ç–æ–≤, 57 assertions)

// GET /api/v1/admin/post-types (PostTypesTest.php) - 2 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can list post types')
‚úÖ test('post types are sorted by slug')

// POST /api/v1/admin/post-types (PostTypesTest.php) - 5 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can create post type')
‚úÖ test('post type slug is unique')
‚úÖ test('post type validation fails with missing slug')
‚úÖ test('post type validation fails with missing name')
‚úÖ test('post type can be created with custom fields in options')

// GET /api/v1/admin/post-types/{slug} (PostTypesTest.php) - 2 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can view post type')
‚úÖ test('show not found returns 404')

// PUT /api/v1/admin/post-types/{slug} (PostTypesTest.php) - 4 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can update post type')
‚úÖ test('post type slug can be updated')
‚úÖ test('post type options can be updated')
‚úÖ test('update not found returns 404')

// DELETE /api/v1/admin/post-types/{slug} (PostTypesTest.php) - 4 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can delete post type')
‚úÖ test('cannot delete post type with entries')
‚úÖ test('can force delete post type with entries')
‚úÖ test('delete not found returns 404')

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   17 Feature —Ç–µ—Å—Ç–æ–≤ –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è post types
-   –¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å slug
-   –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏—è (—Ç—Ä–µ–±—É—é—Ç—Å—è slug –∏ name)
-   –¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞ —Å options_json (custom fields)
-   –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∑–∞—â–∏—Ç–∞ –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ —Å —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ entries
-   –¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (`force=1`) —Å –∫–∞—Å–∫–∞–¥–Ω—ã–º —É–¥–∞–ª–µ–Ω–∏–µ–º entries
-   Middleware `JwtAuth`, `VerifyApiCsrf` –∏ `EnsureCanManagePostTypes` –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ —Ç–µ—Å—Ç–∞—Ö

---

### 3.5. Plugins API

#### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (31 —Ç–µ—Å—Ç, 136 assertions)

// GET /api/v1/admin/plugins (ListPluginsTest.php) - 11 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can list plugins')
‚úÖ test('plugins list is paginated')
‚úÖ test('plugins can be filtered by enabled status')
‚úÖ test('plugins can be filtered by disabled status')
‚úÖ test('plugins can be searched by slug')
‚úÖ test('plugins can be searched by name')
‚úÖ test('plugins can be sorted by name')
‚úÖ test('plugins can be sorted by slug')
‚úÖ test('plugins can be sorted by version')
‚úÖ test('plugins include routes_active flag')
‚úÖ test('plugins include all metadata fields')

// POST /api/v1/admin/plugins/{slug}/enable (EnableDisablePluginTest.php) - 6 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can enable plugin')
‚úÖ test('enabling already enabled plugin returns conflict')
‚úÖ test('enable returns 404 for non-existent plugin')
‚úÖ test('enable triggers route reload')
‚úÖ test('enable returns plugin resource with correct structure')
‚úÖ test('enable dispatches plugin enabled event')

// POST /api/v1/admin/plugins/{slug}/disable (EnableDisablePluginTest.php) - 6 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can disable plugin')
‚úÖ test('disabling already disabled plugin returns conflict')
‚úÖ test('disable returns 404 for non-existent plugin')
‚úÖ test('disable triggers route reload')
‚úÖ test('disable returns plugin resource with correct structure')
‚úÖ test('disable dispatches plugin disabled event')

// POST /api/v1/admin/plugins/sync (SyncPluginsTest.php) - 8 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can sync plugins')
‚úÖ test('sync returns accepted status code 202')
‚úÖ test('sync returns summary with added plugins')
‚úÖ test('sync returns summary with updated plugins')
‚úÖ test('sync returns summary with removed plugins')
‚úÖ test('sync returns summary with providers')
‚úÖ test('sync returns correct structure')
‚úÖ test('sync handles empty summary gracefully')

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   31 Feature —Ç–µ—Å—Ç –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ 4 —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ Plugins API
-   **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏:
    -   `RouteReloader` (–¥–ª—è `PluginsRouteReloader`)
    -   `PluginsSynchronizerInterface` (–¥–ª—è `PluginsSynchronizer`)
    -   `PluginActivatorInterface` (–¥–ª—è `PluginActivator`)
-   –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `AppServiceProvider::register()`
-   –¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:
    -   –ü–∞–≥–∏–Ω–∞—Ü–∏—è, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –ø–æ–∏—Å–∫, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (LIST)
    -   Enable/Disable —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (409)
    -   –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (mock `RouteReloader`)
    -   –°–æ–±—ã—Ç–∏—è: `PluginEnabled`, `PluginDisabled`
    -   Sync —Å –ø–æ–ª–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π (added, updated, removed, providers)
    -   404 –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–ª–∞–≥–∏–Ω–æ–≤
-   Middleware `JwtAuth`, `VerifyApiCsrf` –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ —Ç–µ—Å—Ç–∞—Ö

---

### 3.6. Options API

#### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (22 —Ç–µ—Å—Ç–∞, 81 assertion)

// GET /api/v1/admin/options/{namespace} (OptionsTest.php) - 8 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can list options by namespace')
‚úÖ test('options list is paginated')
‚úÖ test('options can be searched by key')
‚úÖ test('options can be searched by description')
‚úÖ test('options list can include soft deleted')
‚úÖ test('options list can show only soft deleted')
‚úÖ test('options are sorted by key')

// GET /api/v1/admin/options/{namespace}/{key} (OptionsTest.php) - 2 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can view single option')
‚úÖ test('show returns 404 for non-existent option')

// PUT /api/v1/admin/options/{namespace}/{key} (OptionsTest.php) - 6 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can create new option')
‚úÖ test('admin can update existing option')
‚úÖ test('option can store array values')
‚úÖ test('option can store object values')
‚úÖ test('option description is optional')
‚úÖ test('put dispatches option changed event')

// DELETE /api/v1/admin/options/{namespace}/{key} (OptionsTest.php) - 2 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can delete option')
‚úÖ test('delete returns 404 for non-existent option')

// POST /api/v1/admin/options/{namespace}/{key}/restore (OptionsTest.php) - 3 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can restore deleted option')
‚úÖ test('restore returns 404 for non-existent option')
‚úÖ test('restore on non-deleted option returns the option unchanged')

// VALIDATION (OptionsTest.php) - 2 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('invalid namespace returns validation error')
‚úÖ test('invalid key returns validation error')

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   22 Feature —Ç–µ—Å—Ç–∞ –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ 5 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ Options API
-   –¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:
    -   –ü–∞–≥–∏–Ω–∞—Ü–∏—è, –ø–æ–∏—Å–∫ (–ø–æ key/description)
    -   –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è soft-deleted –æ–ø—Ü–∏–π (with/only)
    -   –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–ª—é—á—É
    -   Upsert (—Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ) –æ–ø—Ü–∏–π
    -   –•—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–Ω–∞—á–µ–Ω–∏–π (string, array, object)
    -   Soft delete –∏ restore –æ–ø—Ü–∏–π
    -   –°–æ–±—ã—Ç–∏–µ `OptionChanged`
    -   –í–∞–ª–∏–¥–∞—Ü–∏—è namespace/key (regex pattern)
    -   404 –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –æ–ø—Ü–∏–π
-   –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π –æ–ø—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è 201 (Created)
-   –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –æ–ø—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è 200 (OK)
-   OptionResource –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç JSON –≤ –æ–±—ä–µ–∫—Ç—ã (stdClass)
-   Middleware `JwtAuth`, `VerifyApiCsrf` –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ —Ç–µ—Å—Ç–∞—Ö

---

### 3.7. Taxonomies & Terms API

#### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (37 —Ç–µ—Å—Ç–æ–≤, 143 assertions)

**Taxonomies API** (TaxonomiesTest.php) - 19 —Ç–µ—Å—Ç–æ–≤, 72 assertions

// GET /api/v1/admin/taxonomies - 5 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can list taxonomies')
‚úÖ test('taxonomies list is paginated')
‚úÖ test('taxonomies can be searched by name')
‚úÖ test('taxonomies can be sorted by created_at desc')
‚úÖ test('taxonomies can be sorted by label asc')

// POST /api/v1/admin/taxonomies - 4 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can create taxonomy')
‚úÖ test('taxonomy defaults to non-hierarchical')
‚úÖ test('taxonomy can have options_json')
‚úÖ test('taxonomy label is required')

// GET /api/v1/admin/taxonomies/{id} - 2 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can view taxonomy')
‚úÖ test('show returns 404 for non-existent taxonomy')

// PUT /api/v1/admin/taxonomies/{id} - 4 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can update taxonomy label')
‚úÖ test('admin can update taxonomy hierarchical flag')
‚úÖ test('admin can update taxonomy options_json')
‚úÖ test('update returns 404 for non-existent taxonomy')

// DELETE /api/v1/admin/taxonomies/{id} - 4 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can delete taxonomy without terms')
‚úÖ test('cannot delete taxonomy with terms')
‚úÖ test('can force delete taxonomy with terms')
‚úÖ test('delete returns 404 for non-existent taxonomy')

**Terms API** (TermsTest.php) - 18 —Ç–µ—Å—Ç–æ–≤, 71 assertion

// GET /api/v1/admin/taxonomies/{taxonomy}/terms - 5 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
‚úÖ test('admin can list terms by taxonomy')
‚úÖ test('terms list is paginated')
‚úÖ test('terms can be searched by name')
‚úÖ test('terms can be sorted by name asc')
‚úÖ test('returns 404 for non-existent taxonomy')

// GET /api/v1/admin/taxonomies/{taxonomy}/terms/tree - 1 —Ç–µ—Å—Ç ‚úÖ
‚úÖ test('admin can get terms tree')

// POST /api/v1/admin/taxonomies/{taxonomy}/terms - 4 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can create term')
‚úÖ test('term can have meta_json')
‚úÖ test('term can have parent')
‚úÖ test('term name is required')

// GET /api/v1/admin/terms/{term} - 2 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can view term')
‚úÖ test('show returns 404 for non-existent term')

// PUT /api/v1/admin/terms/{term} - 4 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can update term name')
‚úÖ test('admin can update term meta_json')
‚úÖ test('admin can change term parent')
‚úÖ test('update returns 404 for non-existent term')

// DELETE /api/v1/admin/terms/{term} - 2 —Ç–µ—Å—Ç–∞ ‚úÖ
‚úÖ test('admin can delete term')
‚úÖ test('delete returns 404 for non-existent term')

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   37 Feature —Ç–µ—Å—Ç–æ–≤ –ø–æ–∫—Ä—ã–≤–∞—é—Ç 10 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ (5 Taxonomies + 5 Terms)
-   **Taxonomies:**
    -   –ü–∞–≥–∏–Ω–∞—Ü–∏—è, –ø–æ–∏—Å–∫, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (created_at, label)
    -   –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –∏ –ø–ª–æ—Å–∫–∏–µ —Ç–∞–∫—Å–æ–Ω–æ–º–∏–∏
    -   options_json –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
    -   –ó–∞—â–∏—Ç–∞ –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è —Ç–∞–∫—Å–æ–Ω–æ–º–∏–π —Å —Ç–µ—Ä–º–∞–º–∏
    -   Force delete —Å –∫–∞—Å–∫–∞–¥–Ω—ã–º —É–¥–∞–ª–µ–Ω–∏–µ–º —Ç–µ—Ä–º–æ–≤
-   **Terms:**
    -   –ü–∞–≥–∏–Ω–∞—Ü–∏—è, –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
    -   –ò–µ—Ä–∞—Ä—Ö–∏—è —Ç–µ—Ä–º–æ–≤ (parent_id, tree endpoint)
    -   meta_json –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
    -   –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–µ–π —á–µ—Ä–µ–∑ `TermHierarchyService`
-   Taxonomy –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–µ `name` –≤ –ë–î, –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `label` –≤ API
-   Terms –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏—Ö —Ç–∞–∫—Å–æ–Ω–æ–º–∏–π
-   Middleware `JwtAuth`, `VerifyApiCsrf` –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ —Ç–µ—Å—Ç–∞—Ö

---

### 3.8. Search API

#### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Admin/Search/SearchAdminTest.php`) ‚Äî 9 —Ç–µ—Å—Ç–æ–≤:

```php
// POST /api/v1/admin/search/reindex
‚úÖ test('admin can trigger reindex')
‚úÖ test('reindex job is dispatched with tracking id')
‚úÖ test('reindex returns batch size from config')
‚úÖ test('reindex returns estimated total from published entries')
‚úÖ test('reindex fails when search is disabled')
‚úÖ test('reindex requires authentication')
‚úÖ test('reindex returns unique job id')
‚úÖ test('reindex job id is a valid ulid')
‚úÖ test('reindex with zero published entries returns zero estimated total')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Public/Search/PublicSearchTest.php`) ‚Äî 15 —Ç–µ—Å—Ç–æ–≤:

```php
// GET /api/v1/search
‚úÖ test('public can search published entries')
‚úÖ test('draft entries are not in results')
‚úÖ test('search results are paginated')
‚úÖ test('search returns etag header')
‚úÖ test('search returns cache control headers')
‚úÖ test('search accepts post type filter')
‚úÖ test('search accepts term filter')
‚úÖ test('search accepts date range filter')
‚úÖ test('search validates query min length')
‚úÖ test('search validates query max length')
‚úÖ test('search validates date range')
‚úÖ test('search without query parameter works')
‚úÖ test('search highlights matches in results')
‚úÖ test('search returns score for relevance sorting')
‚úÖ test('search returns took ms in meta')
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ:**

-   **–°–æ–∑–¥–∞–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** `SearchServiceInterface` –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è `final` –∫–ª–∞—Å—Å–∞ `SearchService`
-   **–û–±–Ω–æ–≤–ª—ë–Ω** `SearchServiceProvider`: –¥–æ–±–∞–≤–ª–µ–Ω –±–∏–Ω–¥–∏–Ω–≥ `SearchServiceInterface ‚Üí SearchService`
-   **–û–±–Ω–æ–≤–ª—ë–Ω** `SearchController`: —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `SearchServiceInterface` –≤–º–µ—Å—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ `SearchService`

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   –ü—É–±–ª–∏—á–Ω—ã–π Search API –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–¥–ª—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞)
-   Admin Reindex API –¥–∏—Å–ø–∞—Ç—á–∏—Ç `ReindexSearchJob` –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
-   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 202 (Accepted) —Å `job_id`, `batch_size`, `estimated_total`
-   –ü—Ä–æ–≤–µ—Ä—è–µ—Ç `config('search.enabled')` –ø–µ—Ä–µ–¥ –¥–∏—Å–ø–∞—Ç—á–µ–º –¥–∂–æ–±—ã
-   –ü—É–±–ª–∏—á–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä—ã: `post_type[]`, `term[]`, `from`, `to`, `page`, `per_page`
-   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç ETag –∏ Cache-Control –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
-   –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–¥—Å–≤–µ—Ç–∫—É (highlighting) —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –ø–æ–∏—Å–∫–∞

---

### 3.9. Path Reservation API

#### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Admin/PathReservations/PathReservationsTest.php`) ‚Äî 21 —Ç–µ—Å—Ç:

```php
// GET /api/v1/admin/reservations
‚úÖ test('admin can list reserved paths')
‚úÖ test('list returns empty array when no reservations')
‚úÖ test('list is sorted by path')
‚úÖ test('list requires authentication')
‚úÖ test('list includes reservation metadata')

// POST /api/v1/admin/reservations
‚úÖ test('admin can reserve path')
‚úÖ test('reservation creates audit log')
‚úÖ test('duplicate path returns conflict error')
‚úÖ test('reservation validates required fields')
‚úÖ test('reservation validates path max length')
‚úÖ test('reservation validates source max length')
‚úÖ test('reservation reason is optional')
‚úÖ test('reservation requires admin permissions')
‚úÖ test('paths are normalized before reservation')

// DELETE /api/v1/admin/reservations/{path}
‚úÖ test('admin can release path reservation')
‚úÖ test('release creates audit log')
‚úÖ test('release from wrong source returns forbidden')
‚úÖ test('release validates required source')
‚úÖ test('release path can be in body if not in url')
‚úÖ test('release requires authentication')
‚úÖ test('release requires admin permissions')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   –ü—É—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –ø–µ—Ä–µ–¥ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–µ–π (lowercase, –±–µ–∑ trailing slash)
-   –°–æ–∑–¥–∞—ë—Ç—Å—è audit log –¥–ª—è `reserve` –∏ `release` –¥–µ–π—Å—Ç–≤–∏–π
-   –ö–æ–Ω—Ñ–ª–∏–∫—Ç (409) –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å —É–∂–µ –∑–∞–Ω—è—Ç—ã–π –ø—É—Ç—å
-   Forbidden (403) –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –ø—É—Ç—å —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º `source`
-   –¢—Ä–µ–±—É–µ—Ç `is_admin = true` –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
-   –ü—É—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å —É–∫–∞–∑–∞–Ω –∫–∞–∫ –≤ URL, —Ç–∞–∫ –∏ –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ (–¥–ª—è DELETE)
-   Middleware `JwtAuth`, `VerifyApiCsrf` –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ —Ç–µ—Å—Ç–∞—Ö

---

### 3.10. Utils & Templates API

#### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Admin/Utils/UtilsTest.php`) ‚Äî 10 —Ç–µ—Å—Ç–æ–≤:

```php
// GET /api/v1/admin/utils/slugify
‚úÖ test('generates slug from title')
‚úÖ test('ensures unique slug when base exists')
‚úÖ test('checks reserved routes when generating slug')
‚úÖ test('slug scoped by post type')
‚úÖ test('handles empty title')
‚úÖ test('handles special characters in title')
‚úÖ test('slugify requires authentication')
‚úÖ test('defaults to page post type when not specified')
‚úÖ test('handles very long titles')
‚úÖ test('generates incremental suffixes for multiple duplicates')
```

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Api/Admin/Templates/TemplatesTest.php`) ‚Äî 17 —Ç–µ—Å—Ç–æ–≤:

```php
// GET /api/v1/admin/templates
‚úÖ test('admin can list templates')
‚úÖ test('list excludes system directories')
‚úÖ test('list returns sorted templates')
‚úÖ test('list requires authentication')

// GET /api/v1/admin/templates/{name}
‚úÖ test('admin can view template content')
‚úÖ test('show returns 404 for non-existent template')
‚úÖ test('show requires authentication')

// POST /api/v1/admin/templates
‚úÖ test('admin can create template')
‚úÖ test('create returns conflict if template exists')
‚úÖ test('create validates required fields')
‚úÖ test('create automatically creates directories')
‚úÖ test('create requires authentication')

// PUT /api/v1/admin/templates/{name}
‚úÖ test('admin can update template')
‚úÖ test('update returns 404 for non-existent template')
‚úÖ test('update validates content required')
‚úÖ test('update requires authentication')
‚úÖ test('template name converts to correct path')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   `slugify` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `base` (–±–∞–∑–æ–≤—ã–π slug) –∏ `unique` (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å —É—á—ë—Ç–æ–º –∫–æ–ª–ª–∏–∑–∏–π)
-   –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –≤ scope post_type
-   –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å `ReservedRoute`
-   Templates API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç CRUD –¥–ª—è Blade —à–∞–±–ª–æ–Ω–æ–≤
-   –ò—Å–∫–ª—é—á–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: `admin`, `errors`, `layouts`, `partials`, `vendor`
-   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —à–∞–±–ª–æ–Ω–æ–≤
-   Middleware `JwtAuth`, `VerifyApiCsrf` –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ —Ç–µ—Å—Ç–∞—Ö

---

### 3.11. Web Controllers

#### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Web/PagesTest.php`) ‚Äî 15 —Ç–µ—Å—Ç–æ–≤:

```php
// GET / (HomeController)
‚úÖ test('homepage renders default template')
‚úÖ test('homepage renders entry when home_entry_id is set')
‚úÖ test('homepage falls back to default when entry is not published')
‚úÖ test('homepage falls back to default when entry is scheduled')
‚úÖ test('homepage uses correct template resolver')

// GET /{slug} (PageController)
‚úÖ test('entry page renders published entry')
‚úÖ test('entry page returns 404 for non-existent slug')
‚úÖ test('entry page returns 404 for draft entry')
‚úÖ test('entry page returns 404 for scheduled entry')
‚úÖ test('entry uses correct template for post type')
‚úÖ test('entry page loads with post type relationship')
‚úÖ test('entry page uses template override if specified')

// GET /admin/ping (AdminPingController)
‚úÖ test('admin ping returns ok')
‚úÖ test('admin ping confirms route priority')

// Routing
‚úÖ test('reserved paths are rejected by middleware')
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

-   `HomeController`: —Ä–µ–Ω–¥–µ—Ä–∏—Ç –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `site:home_entry_id` –æ–ø—Ü–∏—é
-   `PageController`: catch-all —Ä–æ—É—Ç –¥–ª—è `/{slug}`, —Ä–µ–Ω–¥–µ—Ä–∏—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ entries
-   `AdminPingController`: —Ç–µ—Å—Ç–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Ä—è–¥–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–æ—É—Ç–æ–≤
-   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `TemplateResolver` –¥–ª—è –≤—ã–±–æ—Ä–∞ Blade —à–∞–±–ª–æ–Ω–æ–≤
-   –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å `published` –∏ `published_at <= now()`
-   –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `template_override` –¥–ª—è custom —à–∞–±–ª–æ–Ω–æ–≤
-   –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É—Ç–∏ –∑–∞—â–∏—â–µ–Ω—ã —á–µ—Ä–µ–∑ `ReservedPattern` –∏ `RejectReservedIfMatched` middleware

---

## 4. Validation Rules

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (2025-11-17)

#### 4.1. UniqueEntrySlug

**–ü—É—Ç—å:** `app/Rules/UniqueEntrySlug.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Rules/UniqueEntrySlugTest.php`)

```php
- test('passes for unique slug')
- test('fails for duplicate slug in same post type')
- test('passes for duplicate slug in different post type')
- test('passes for same entry on update')
```

---

#### 4.2. ReservedSlug

**–ü—É—Ç—å:** `app/Rules/ReservedSlug.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Rules/ReservedSlugTest.php`)

```php
- test('passes for non-reserved slug')
- test('fails for reserved path')
- test('fails for reserved prefix')
```

---

#### 4.3. Publishable

**–ü—É—Ç—å:** `app/Rules/Publishable.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Rules/PublishableTest.php`)

```php
- test('passes for valid publishable state')
- test('fails if required fields missing')
```

---

#### 4.4. PublishedDateNotInFuture

**–ü—É—Ç—å:** `app/Rules/PublishedDateNotInFuture.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Rules/PublishedDateNotInFutureTest.php`)

```php
- test('passes for past date')
- test('passes for current date')
- test('fails for future date')
```

---

#### 4.5. NoTermCycle

**–ü—É—Ç—å:** `app/Rules/NoTermCycle.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Rules/NoTermCycleTest.php`)

```php
- test('passes for non-cyclic hierarchy')
- test('fails for direct cycle')
- test('fails for indirect cycle')
```

---

#### 4.6. JsonValue

**–ü—É—Ç—å:** `app/Rules/JsonValue.php`

**Unit-—Çes—Ç—ã** (`tests/Unit/Rules/JsonValueTest.php`)

```php
- test('passes for valid json')
- test('passes for null')
- test('fails for invalid json')
```

---

## 5. Integration Tests

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π

**Feature-—Ç–µ—Å—Ç—ã** (`tests/Feature/Integration/`)

#### 5.1. MediaProcessingPipelineTest.php

```php
- test('complete media processing pipeline')
- test('image upload, validation, storage, variant generation')
- test('video upload with metadata extraction')
- test('pdf upload and validation')
```

---

#### 5.2. SearchReindexingTest.php

```php
- test('full reindex updates all entries')
- test('zero-downtime reindex with alias swap')
- test('incremental indexing on entry changes')
```

---

#### 5.3. PluginSystemTest.php

```php
- test('plugin activation loads routes')
- test('plugin deactivation removes routes')
- test('plugin sync discovers new plugins')
```

---

#### 5.4. EntryLifecycleTest.php

```php
- test('entry creation, publishing, updating, deletion')
- test('entry with terms')
- test('entry slug reservation and validation')
```

---

## 6. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (1-2 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –ü–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–∞–º–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ —á–∞—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

1. ‚úÖ **Auth Module** (JwtService, RefreshTokenRepository)
2. ‚úÖ **Models** (User, Entry, Media, PostType)
3. ‚úÖ **Media Actions** (MediaStoreAction, MediaValidation)
4. ‚úÖ **Auth API** (Login, Refresh, Logout)
5. ‚úÖ **Entries API** (CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏)

### –§–∞–∑–∞ 2: –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (2-3 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –ü–æ–∫—Ä—ã—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É

1. **Media Module** (–≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã)
2. **Media API** (–∑–∞–≥—Ä—É–∑–∫–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
3. **–û—Å—Ç–∞–ª—å–Ω—ã–µ Models** (–≤—Å–µ 16 –º–æ–¥–µ–ª–µ–π)
4. **Search Module** (–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è, –ø–æ–∏—Å–∫)
5. **Routing Module** (—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É—Ç–µ–π)

### –§–∞–∑–∞ 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (1-2 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –ü–æ–∫—Ä—ã—Ç—å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏

1. **Plugins Module** (–∞–∫—Ç–∏–≤–∞—Ü–∏—è, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)
2. **PostTypes, Taxonomies, Terms API**
3. **Options Module**
4. **Validation Rules**
5. **View Module**

### –§–∞–∑–∞ 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (1 –Ω–µ–¥–µ–ª—è)

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

1. **MediaProcessingPipeline**
2. **SearchReindexing**
3. **PluginSystem**
4. **EntryLifecycle**

---

## 7. –ú–µ—Ç—Ä–∏–∫–∏ –∏ —Ü–µ–ª–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

### –¶–µ–ª–µ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ

-   **Unit-—Ç–µ—Å—Ç—ã:** 80%+ –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
-   **Feature-—Ç–µ—Å—Ç—ã:** 100% –ø–æ–∫—Ä—ã—Ç–∏–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
-   **Models:** 100% –ø–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
-   **Integration:** –ü–æ–∫—Ä—ã—Ç–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

-   –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
-   –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Unit-—Ç–µ—Å—Ç–æ–≤ < 30 —Å–µ–∫
-   –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Feature-—Ç–µ—Å—Ç–æ–≤ < 2 –º–∏–Ω
-   –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ < 3 –º–∏–Ω

---

## 8. –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
composer test

# –ü–æ —Ç–∏–ø–∞–º
composer test:unit
composer test:feature

# –ü–æ –º–æ–¥—É–ª—è–º
composer test:module:auth
composer test:module:media
composer test:module:entries
composer test:module:plugins
composer test:module:search

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
composer test:coverage
php artisan test --coverage --min=80

# –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
composer test:parallel
```

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

```bash
# Unit-—Ç–µ—Å—Ç
php artisan make:test Unit/Domain/Media/Services/ExifManagerTest --unit

# Feature-—Ç–µ—Å—Ç
php artisan make:test Feature/Api/Admin/V1/Media/MediaManagementTest
```

---

## 9. –®–∞–±–ª–æ–Ω—ã —Ç–µ—Å—Ç–æ–≤

### Unit-—Ç–µ—Å—Ç (Action)

```php
<?php

declare(strict_types=1);

use App\Domain\Media\Actions\MediaStoreAction;
use Illuminate\Http\UploadedFile;

test('stores media file successfully', function () {
    // Arrange
    $action = app(MediaStoreAction::class);
    $file = UploadedFile::fake()->image('test.jpg');

    // Act
    $media = $action->execute($file, 'default');

    // Assert
    expect($media)
        ->toBeInstanceOf(Media::class)
        ->and($media->mime_type)->toBe('image/jpeg')
        ->and($media->exists)->toBeTrue();
});
```

### Feature-—Ç–µ—Å—Ç (API)

```php
<?php

declare(strict_types=1);

use App\Models\User;
use Illuminate\Http\UploadedFile;
use function Pest\Laravel\postJson;

test('admin can upload media', function () {
    // Arrange
    $admin = User::factory()->admin()->create();
    $file = UploadedFile::fake()->image('photo.jpg', 1920, 1080);

    // Act
    $response = $this->actingAs($admin, 'jwt')
        ->postJson('/api/v1/admin/media', [
            'file' => $file,
            'title' => 'Test Photo',
            'collection' => 'default',
        ]);

    // Assert
    $response->assertStatus(201)
        ->assertJsonStructure([
            'data' => ['id', 'title', 'url', 'mime_type'],
        ]);

    $this->assertDatabaseHas('media', [
        'title' => 'Test Photo',
        'mime_type' => 'image/jpeg',
    ]);
});
```

---

## 10. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–î–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –ø–æ–∫—Ä—ã–≤–∞–µ—Ç **–≤—Å–µ 170 —Å—É—â–Ω–æ—Å—Ç–µ–π –ø—Ä–æ–µ–∫—Ç–∞**:

-   ‚úÖ 16 –º–æ–¥–µ–ª–µ–π
-   ‚úÖ 63 –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞
-   ‚úÖ 60 HTTP —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
-   ‚úÖ 6 –ø—Ä–∞–≤–∏–ª –≤–∞–ª–∏–¥–∞—Ü–∏–∏
-   ‚úÖ –°–æ–±—ã—Ç–∏—è, —Å–ª—É—à–∞—Ç–µ–ª–∏, jobs
-   ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

–ü–ª–∞–Ω —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω –ø–æ –º–æ–¥—É–ª—è–º, –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –ø–æ—ç—Ç–∞–ø–Ω–æ–º—É –≤–Ω–µ–¥—Ä–µ–Ω–∏—é.

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—á–∞—Ç—å —Å –§–∞–∑—ã 1 (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã) —Å–æ–≥–ª–∞—Å–Ω–æ –ø–ª–∞–Ω—É –≤–Ω–µ–¥—Ä–µ–Ω–∏—è.

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∞:** –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

---

_–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 2025-11-17_  
_–í–µ—Ä—Å–∏—è: 1.0_
