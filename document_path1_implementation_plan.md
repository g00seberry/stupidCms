# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –î–æ–∫—É–º–µ–Ω—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å path-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–µ–π

> **–°—Ç–∞—Ç—É—Å:** Ready for development  
> **–í–µ—Ä—Å–∏—è:** 1.0  
> **–î–∞—Ç–∞:** 2025-11-20  
> **–û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞:** `document_path1.md`, `document_path1_task_breakdown_plan.md`

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è](#1-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ-—Ä–µ—à–µ–Ω–∏—è)
2. [Roadmap –∏ —ç—Ç–∞–ø—ã](#2-roadmap-–∏-—ç—Ç–∞–ø—ã)
3. [Sprint Planning](#3-sprint-planning)
4. [–î–µ—Ç–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏](#4-–¥–µ—Ç–∞–ª—å–Ω—ã–µ-–∑–∞–¥–∞—á–∏)
5. [Definition of Done](#5-definition-of-done)
6. [–†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è](#6-—Ä–∏—Å–∫–∏-–∏-–º–∏—Ç–∏–≥–∞—Ü–∏—è)
7. [–ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤](#7-–∫–æ–º–∞–Ω–¥—ã-–¥–ª—è-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

---

## 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1.1. –ü—Ä–∏–Ω—è—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è ‚úÖ

| –†–µ—à–µ–Ω–∏–µ                   | –ó–Ω–∞—á–µ–Ω–∏–µ              | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ                         |
| ------------------------- | --------------------- | ----------------------------------- |
| **MySQL –≤–µ—Ä—Å–∏—è**          | 8.0.16+               | –ù–∞—Ç–∏–≤–Ω—ã–µ CHECK constraints          |
| **–¢–∞–±–ª–∏—Ü–∞ Entry**         | –û—Ç–¥–µ–ª—å–Ω–∞—è pivot       | –ò–∑–æ–ª—è—Ü–∏—è, –Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è —ç–≤–æ–ª—é—Ü–∏—è      |
| **–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã**          | –¢–æ–ª—å–∫–æ —Å blueprint    | –£–ø—Ä–æ—â–µ–Ω–∏–µ, —Ñ–æ–∫—É—Å –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–µ        |
| **–ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è**        | –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è            | –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å         |
| **–í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã paths**      | validation_rules JSON | –ì–∏–±–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö             |
| **SoftDeletes blueprint** | –ù–µ—Ç                   | –£–ø—Ä–æ—â–µ–Ω–∏–µ –∫–∞—Å–∫–∞–¥–æ–≤                  |
| **–õ–∏–º–∏—Ç –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏**     | MAX_EMBED_DEPTH = 5   | –ó–∞—â–∏—Ç–∞ —Å—Ç–µ–∫–∞, —Ä–∞–∑—É–º–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ  |
| **–ê–≤—Ç–æ–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ**    | –ù–µ—Ç                   | –Ø–≤–Ω—ã–µ –æ—à–∏–±–∫–∏, –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ |

### 1.2. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –õ–ò–ú–ò–¢–´                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ MAX_EMBED_DEPTH          = 5            ‚îÇ
‚îÇ MAX_PATHS_PER_BLUEPRINT  = 500          ‚îÇ
‚îÇ MAX_BLUEPRINT_IN_GRAPH   = 200          ‚îÇ
‚îÇ MATERIALIZATION_TIMEOUT  = 120 —Å–µ–∫—É–Ω–¥   ‚îÇ
‚îÇ REINDEX_BATCH_SIZE       = 100 entries  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## 2. Roadmap –∏ —ç—Ç–∞–ø—ã

### 2.1. Timeline (8 –Ω–µ–¥–µ–ª—å –¥–ª—è 2 —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

```
Week 1-2: –≠—Ç–∞–ø 1 (–ë–î –∏ –º–æ–¥–µ–ª–∏)
Week 3-5: –≠—Ç–∞–ø 2 (–í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ)
Week 6:   –≠—Ç–∞–ø 3 (–ö–∞—Å–∫–∞–¥—ã)
Week 7:   –≠—Ç–∞–ø 4 (–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è)
Week 8:   –≠—Ç–∞–ø 5 (API + —Ç–µ—Å—Ç—ã)
```

### 2.2. Milestones

```
M1 ‚úÖ –ë–î –≥–æ—Ç–æ–≤–∞              (Week 2)
M2 ‚úÖ –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç    (Week 5)
M3 ‚úÖ –ö–∞—Å–∫–∞–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç        (Week 6)
M4 ‚úÖ –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç     (Week 7)
M5 ‚úÖ Production-ready        (Week 8)
```

### 2.3. –≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```mermaid
graph LR
    A[–≠—Ç–∞–ø 1: –ë–î] --> B[–≠—Ç–∞–ø 2: –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ]
    B --> C[–≠—Ç–∞–ø 3: –ö–∞—Å–∫–∞–¥—ã]
    C --> D[–≠—Ç–∞–ø 4: –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è]
    D --> E[–≠—Ç–∞–ø 5: API]
```

---

## 3. Sprint Planning

### Sprint 1 (Week 1): –§—É–Ω–¥–∞–º–µ–Ω—Ç –ë–î

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å —Å—Ö–µ–º—É –ë–î —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –∏ –±–∞–∑–æ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏

**–ó–∞–¥–∞—á–∏:**

-   [ ] TASK-001: –ú–∏–≥—Ä–∞—Ü–∏—è `blueprints`
-   [ ] TASK-002: –ú–∏–≥—Ä–∞—Ü–∏—è `paths` (–±–µ–∑ FK blueprint_embed_id)
-   [ ] TASK-003: –ú–∏–≥—Ä–∞—Ü–∏—è `blueprint_embeds`
-   [ ] TASK-004: –ú–∏–≥—Ä–∞—Ü–∏—è FK `paths.blueprint_embed_id`
-   [ ] TASK-005: –ú–æ–¥–µ–ª—å `Blueprint` + —Å–≤—è–∑–∏
-   [ ] TASK-006: –ú–æ–¥–µ–ª—å `Path` + —Å–≤—è–∑–∏ + $guarded
-   [ ] TASK-007: –ú–æ–¥–µ–ª—å `BlueprintEmbed` + —Å–≤—è–∑–∏
-   [ ] TASK-008: –§–∞–±—Ä–∏–∫–∏ –¥–ª—è –º–æ–¥–µ–ª–µ–π
-   [ ] TASK-009: Unit-—Ç–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π

**–ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ Sprint 1:**

-   ‚úÖ –í—Å–µ 4 –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
-   ‚úÖ –ú–æ–¥–µ–ª–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ–∞–±—Ä–∏–∫–∏
-   ‚úÖ –°–≤—è–∑–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
-   ‚úÖ –¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π –∑–µ–ª—ë–Ω—ã–µ

---

### Sprint 2 (Week 2): –í–∞–ª–∏–¥–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞

**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ü–∏–∫–ª–æ–≤ –∏ –≥—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–ó–∞–¥–∞—á–∏:**

-   [ ] TASK-010: `CyclicDependencyValidator::ensureNoCyclicDependency()`
-   [ ] TASK-011: `CyclicDependencyValidator::hasPathTo()` (BFS)
-   [ ] TASK-012: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ `CyclicDependencyException`
-   [ ] TASK-013: Unit-—Ç–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ü–∏–∫–ª–æ–≤
    -   Self-embed (A ‚Üí A)
    -   –ü—Ä—è–º–æ–π —Ü–∏–∫–ª (A ‚Üí B ‚Üí A)
    -   –¢—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã–π —Ü–∏–∫–ª (A ‚Üí B ‚Üí C ‚Üí A)
    -   –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –±–µ–∑ —Ü–∏–∫–ª–∞
-   [ ] TASK-014: `BlueprintDependencyService::getAllDependentBlueprintIds()`

**–ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ Sprint 2:**

-   ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–∏–∫–ª–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
-   ‚úÖ –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ü–∏–∫–ª–æ–≤
-   ‚úÖ –ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å—Ç—Ä–æ–∏—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### Sprint 3 (Week 3): PRE-CHECK –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏

**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ full_path

**–ó–∞–¥–∞—á–∏:**

-   [ ] TASK-015: `PathConflictValidator::validateNoPathConflictsBeforeMaterialization()`
-   [ ] TASK-016: `PathConflictValidator::collectFuturePathsRecursive()` (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Å–±–æ—Ä)
-   [ ] TASK-017: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ `PathConflictException` —Å –¥–µ—Ç–∞–ª—è–º–∏
-   [ ] TASK-018: Unit-—Ç–µ—Å—Ç—ã PRE-CHECK
    -   –ö–æ–Ω—Ñ–ª–∏–∫—Ç —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º –ø–æ–ª–µ–º
    -   –ö–æ–Ω—Ñ–ª–∏–∫—Ç –º–µ–∂–¥—É –¥–≤—É–º—è embeds
    -   –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ (—É—Å–ø–µ—Ö)
-   [ ] TASK-019: –•–µ–ª–ø–µ—Ä `Path::computeFullPath()`

**–ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ Sprint 3:**

-   ‚úÖ PRE-CHECK –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –î–û –≤—Å—Ç–∞–≤–∫–∏
-   ‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –ø–æ–Ω—è—Ç–Ω—ã
-   ‚úÖ –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç edge cases

---

### Sprint 4-5 (Week 4-5): –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è

**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —è–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã ‚Äî –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é —Å —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω–æ—Å—Ç—å—é

**–ó–∞–¥–∞—á–∏:**

-   [ ] TASK-020: `BlueprintStructureService::materializeEmbeddedBlueprint()`
    -   DB::transaction
    -   PRE-CHECK –≤—ã–∑–æ–≤
    -   –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∫–æ–ø–∏–π
    -   –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –∫–æ–ø–∏—Ä–æ–≤—â–∏–∫
-   [ ] TASK-021: `BlueprintStructureService::copyBlueprintRecursive()`
    -   –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö paths
    -   –†–µ–∫—É—Ä—Å–∏—è –ø–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–º embeds
    -   –ö–∞—Ä—Ç–∞ id —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π
    -   –í—ã—á–∏—Å–ª–µ–Ω–∏–µ full_path
    -   –ü—Ä–æ–≤–µ—Ä–∫–∞ MAX_EMBED_DEPTH = 5
-   [ ] TASK-022: `BlueprintStructureService::createEmbed()`
    -   –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–∏–∫–ª–æ–≤
    -   –°–æ–∑–¥–∞–Ω–∏–µ BlueprintEmbed
    -   –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
-   [ ] TASK-023: `BlueprintStructureService::deleteEmbed()`
    -   –£–¥–∞–ª–µ–Ω–∏–µ BlueprintEmbed
    -   –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–ø–∏–π
-   [ ] TASK-024: Unit-—Ç–µ—Å—Ç—ã –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    -   –ü—Ä–æ—Å—Ç–æ–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ (A ‚Üí B)
    -   –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ (Address –¥–≤–∞–∂–¥—ã –≤ Company)
    -   –¢—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω–æ–µ (D ‚Üí C ‚Üí A ‚Üí B)
    -   –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ (author.contacts ‚Üê ContactInfo)
    -   –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ MAX_EMBED_DEPTH
-   [ ] TASK-025: Integration-—Ç–µ—Å—Ç full flow

**–ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ Sprint 4-5:**

-   ‚úÖ –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ
-   ‚úÖ –í—Å–µ —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—è –∫–æ–ø–∏—Ä—É—é—Ç—Å—è
-   ‚úÖ –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –≥–ª—É–±–∏–Ω—ã –±—Ä–æ—Å–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
-   ‚úÖ Integration-—Ç–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç

---

### Sprint 6 (Week 6): –ö–∞—Å–∫–∞–¥–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è

**–¶–µ–ª—å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–ó–∞–¥–∞—á–∏:**

-   [ ] TASK-026: Event `BlueprintStructureChanged`
-   [ ] TASK-027: Listener `RematerializeEmbeds`
    -   –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏—è (processedBlueprints)
    -   –†–µ–º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è embeds
    -   –ö–∞—Å–∫–∞–¥–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π
-   [ ] TASK-028: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `BlueprintStructureService`
-   [ ] TASK-029: Unit-—Ç–µ—Å—Ç—ã –∫–∞—Å–∫–∞–¥–æ–≤
    -   –ò–∑–º–µ–Ω–µ–Ω–∏–µ A ‚Üí —Ä–µ–º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è B
    -   –¢—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ (Geo ‚Üí Address ‚Üí Company)
    -   –ó–∞—â–∏—Ç–∞ –æ—Ç —Ü–∏–∫–ª–æ–≤ –≤ —Å–æ–±—ã—Ç–∏—è—Ö
-   [ ] TASK-030: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Å–∫–∞–¥–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ Sprint 6:**

-   ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
-   ‚úÖ –¶–µ–ø–æ—á–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
-   ‚úÖ –ù–µ—Ç –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–π

---

### Sprint 7 (Week 7): –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é doc_values/doc_refs

**–ó–∞–¥–∞—á–∏:**

-   [ ] TASK-031: –ú–∏–≥—Ä–∞—Ü–∏—è `entries` (pivot)
-   [ ] TASK-032: –ú–∏–≥—Ä–∞—Ü–∏—è `doc_values`
-   [ ] TASK-033: –ú–∏–≥—Ä–∞—Ü–∏—è `doc_refs`
-   [ ] TASK-034: –ú–æ–¥–µ–ª—å `Entry` (pivot)
-   [ ] TASK-035: –ú–æ–¥–µ–ª–∏ `DocValue`, `DocRef`
-   [ ] TASK-036: `EntryIndexer::index(Entry $entry)`
    -   –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤
    -   –û–±—Ö–æ–¥ paths
    -   –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ data_json
    -   –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ doc_values/doc_refs
    -   –û–±—Ä–∞–±–æ—Ç–∫–∞ cardinality=many
-   [ ] TASK-037: Observer `EntryObserver`
    -   –ê–≤—Ç–æ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø—Ä–∏ saved()
    -   –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ deleted()
-   [ ] TASK-038: Job `ReindexBlueprintEntries`
-   [ ] TASK-039: Unit-—Ç–µ—Å—Ç—ã –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
    -   –°–∫–∞–ª—è—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    -   –ú–∞—Å—Å–∏–≤—ã (array_index)
    -   –°—Å—ã–ª–∫–∏ (refs)
-   [ ] TASK-040: Feature-—Ç–µ—Å—Ç—ã Entry CRUD

**–ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ Sprint 7:**

-   ‚úÖ Entry –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
-   ‚úÖ doc_values –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
-   ‚úÖ array_index —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è many

---

### Sprint 8 (Week 8): API –∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è

**–¶–µ–ª—å:** REST API, Query Builder, —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

**–ó–∞–¥–∞—á–∏:**

-   [ ] TASK-041: Trait `HasDocumentData`
    -   `wherePath($path, $operator, $value)`
    -   `wherePathIn($path, $values)`
    -   `whereRef($path, $entryId)`
    -   `orderByPath($path, $direction)`
-   [ ] TASK-042: Controller `BlueprintController` (CRUD)
-   [ ] TASK-043: Controller `PathController` (CRUD —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π readonly)
-   [ ] TASK-044: Controller `BlueprintEmbedController` (CRUD)
-   [ ] TASK-045: Controller `EntryController` (CRUD —Å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–µ–π)
-   [ ] TASK-046: Resources (BlueprintResource, PathResource, EntryResource)
-   [ ] TASK-047: Policies (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
-   [ ] TASK-048: Feature-—Ç–µ—Å—Ç—ã API
-   [ ] TASK-049: Integration-—Ç–µ—Å—Ç—ã full flow
-   [ ] TASK-050: Performance-—Ç–µ—Å—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
-   [ ] TASK-051: Scribe API documentation
-   [ ] TASK-052: README —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ Sprint 8:**

-   ‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
-   ‚úÖ wherePath –∑–∞–ø—Ä–æ—Å—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
-   ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞
-   ‚úÖ Production-ready

---

## 4. –î–µ—Ç–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏

### TASK-001: –ú–∏–≥—Ä–∞—Ü–∏—è `blueprints`

**–§–∞–π–ª:** `database/migrations/YYYY_MM_DD_000001_create_blueprints_table.php`

**–ö–æ–¥:**

```php
Schema::create('blueprints', function (Blueprint $table) {
    $table->id();
    $table->string('name');
    $table->string('code')->unique();
    $table->text('description')->nullable();
    $table->timestamps();
});
```

**Acceptance Criteria:**

-   ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
-   ‚úÖ UNIQUE constraint –Ω–∞ code
-   ‚úÖ Rollback —Ä–∞–±–æ—Ç–∞–µ—Ç

**–¢—Ä—É–¥–æ—ë–º–∫–æ—Å—Ç—å:** 30 –º–∏–Ω—É—Ç

---

### TASK-002: –ú–∏–≥—Ä–∞—Ü–∏—è `paths` (–±–µ–∑ FK blueprint_embed_id)

**–§–∞–π–ª:** `database/migrations/YYYY_MM_DD_000002_create_paths_table.php`

**–ö–æ–¥:**

```php
Schema::create('paths', function (Blueprint $table) {
    $table->id();
    $table->foreignId('blueprint_id')->constrained()->cascadeOnDelete();
    $table->foreignId('source_blueprint_id')->nullable()
        ->constrained('blueprints')->restrictOnDelete();
    $table->unsignedBigInteger('blueprint_embed_id')->nullable(); // FK –ø–æ–∑–∂–µ!
    $table->foreignId('parent_id')->nullable()
        ->constrained('paths')->cascadeOnDelete();

    $table->string('name');
    $table->string('full_path', 2048);
    $table->enum('data_type', ['string','text','int','float','bool','date','datetime','json','ref']);
    $table->enum('cardinality', ['one','many'])->default('one');
    $table->boolean('is_required')->default(false);
    $table->boolean('is_indexed')->default(false);
    $table->boolean('is_readonly')->default(false);
    $table->json('validation_rules')->nullable(); // NEW!
    $table->integer('sort_order')->default(0);
    $table->timestamps();

    $table->unique(['blueprint_id', 'full_path']);

    // CHECK constraint –¥–ª—è –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞ readonly
    DB::statement('ALTER TABLE paths ADD CONSTRAINT chk_paths_readonly_consistency CHECK (
        (source_blueprint_id IS NULL AND blueprint_embed_id IS NULL)
        OR (source_blueprint_id IS NOT NULL AND blueprint_embed_id IS NOT NULL AND is_readonly = 1)
    )');

    $table->index('blueprint_id');
    $table->index('source_blueprint_id');
    $table->index(['blueprint_id', 'parent_id', 'sort_order']);
});
```

**Acceptance Criteria:**

-   ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
-   ‚úÖ CHECK constraint —Ä–∞–±–æ—Ç–∞–µ—Ç
-   ‚úÖ –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
-   ‚úÖ validation_rules –ø–æ–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ

**–¢—Ä—É–¥–æ—ë–º–∫–æ—Å—Ç—å:** 2 —á–∞—Å–∞

---

### TASK-003: –ú–∏–≥—Ä–∞—Ü–∏—è `blueprint_embeds`

**–§–∞–π–ª:** `database/migrations/YYYY_MM_DD_000003_create_blueprint_embeds_table.php`

**–ö–æ–¥:**

```php
Schema::create('blueprint_embeds', function (Blueprint $table) {
    $table->id();
    $table->foreignId('blueprint_id')->constrained()->cascadeOnDelete();
    $table->foreignId('embedded_blueprint_id')
        ->constrained('blueprints')->restrictOnDelete();
    $table->foreignId('host_path_id')->nullable()
        ->constrained('paths')->cascadeOnDelete();
    $table->timestamps();

    $table->unique(['blueprint_id', 'embedded_blueprint_id', 'host_path_id']);
    $table->index('embedded_blueprint_id');
    $table->index('blueprint_id');
});
```

**Acceptance Criteria:**

-   ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
-   ‚úÖ UNIQUE constraint —Ä–∞–±–æ—Ç–∞–µ—Ç
-   ‚úÖ FK –Ω–∞ paths —Ä–∞–±–æ—Ç–∞–µ—Ç

**–¢—Ä—É–¥–æ—ë–º–∫–æ—Å—Ç—å:** 1 —á–∞—Å

---

### TASK-004: –ú–∏–≥—Ä–∞—Ü–∏—è FK `paths.blueprint_embed_id`

**–§–∞–π–ª:** `database/migrations/YYYY_MM_DD_000004_add_blueprint_embed_fk_to_paths.php`

**–ö–æ–¥:**

```php
Schema::table('paths', function (Blueprint $table) {
    $table->foreign('blueprint_embed_id')
        ->references('id')
        ->on('blueprint_embeds')
        ->cascadeOnDelete();

    $table->index('blueprint_embed_id');
});
```

**Acceptance Criteria:**

-   ‚úÖ FK –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
-   ‚úÖ –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–¢—Ä—É–¥–æ—ë–º–∫–æ—Å—Ç—å:** 30 –º–∏–Ω—É—Ç

---

### TASK-020: `BlueprintStructureService::materializeEmbeddedBlueprint()`

**–§–∞–π–ª:** `app/Domain/Blueprints/Services/BlueprintStructureService.php`

**–ö–æ–¥ (–ø—Å–µ–≤–¥–æ–∫–æ–¥):**

```php
public function materializeEmbeddedBlueprint(BlueprintEmbed $embed): void
{
    $hostBlueprint     = $embed->blueprint;
    $embeddedBlueprint = $embed->embeddedBlueprint;
    $hostPath          = $embed->hostPath;

    DB::transaction(function () use ($embed, $hostBlueprint, $embeddedBlueprint, $hostPath) {
        $baseParentId   = $hostPath?->id;
        $baseParentPath = $hostPath?->full_path;

        // 1. PRE-CHECK
        $this->pathConflictValidator->validateNoPathConflictsBeforeMaterialization(
            $embeddedBlueprint,
            $hostBlueprint,
            $baseParentPath
        );

        // 2. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–æ–ø–∏–∏
        Path::where('blueprint_embed_id', $embed->id)->delete();

        // 3. –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å
        $this->copyBlueprintRecursive(
            blueprint:       $embeddedBlueprint,
            hostBlueprint:   $hostBlueprint,
            baseParentId:    $baseParentId,
            baseParentPath:  $baseParentPath,
            rootEmbed:       $embed,
            depth:           0  // NEW!
        );
    }, attempts: 3);
}
```

**Acceptance Criteria:**

-   ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∞—Ç–æ–º–∞—Ä–Ω–∞
-   ‚úÖ PRE-CHECK –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –î–û –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
-   ‚úÖ –°—Ç–∞—Ä—ã–µ –∫–æ–ø–∏–∏ —É–¥–∞–ª—è—é—Ç—Å—è
-   ‚úÖ –†–µ–∫—É—Ä—Å–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

**–¢—Ä—É–¥–æ—ë–º–∫–æ—Å—Ç—å:** 4 —á–∞—Å–∞

---

### TASK-021: `BlueprintStructureService::copyBlueprintRecursive()`

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**

```php
private function copyBlueprintRecursive(
    Blueprint $blueprint,
    Blueprint $hostBlueprint,
    ?int $baseParentId,
    ?string $baseParentPath,
    BlueprintEmbed $rootEmbed,
    int $depth = 0
): void {
    // –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è
    if ($depth > self::MAX_EMBED_DEPTH) {
        throw new MaxEmbedDepthExceededException(
            "Maximum embed depth of " . self::MAX_EMBED_DEPTH . " exceeded"
        );
    }

    // 1. –ö–æ–ø–∏—Ä—É–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ paths
    $sourcePaths = $blueprint->paths()
        ->whereNull('source_blueprint_id')
        ->orderByRaw('LENGTH(full_path), full_path')
        ->get();

    $idMap = [];
    $pathMap = [];

    foreach ($sourcePaths as $source) {
        $copy = $source->replicate([
            'blueprint_id', 'parent_id', 'full_path',
            'source_blueprint_id', 'blueprint_embed_id', 'is_readonly'
        ]);

        $copy->blueprint_id        = $hostBlueprint->id;
        $copy->source_blueprint_id = $blueprint->id;
        $copy->blueprint_embed_id  = $rootEmbed->id;
        $copy->is_readonly         = true;

        // –í—ã—á–∏—Å–ª—è–µ–º parent –∏ full_path
        if ($source->parent_id === null) {
            $parentId   = $baseParentId;
            $parentPath = $baseParentPath;
        } else {
            $parentId   = $idMap[$source->parent_id] ?? null;
            $parentPath = $pathMap[$source->parent_id] ?? null;
        }

        $copy->parent_id = $parentId;
        $copy->full_path = $parentPath
            ? $parentPath . '.' . $copy->name
            : $copy->name;

        $copy->save();

        $idMap[$source->id]   = $copy->id;
        $pathMap[$source->id] = $copy->full_path;
    }

    // 2. –†–µ–∫—É—Ä—Å–∏—è –ø–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–º embeds
    foreach ($blueprint->embeds as $innerEmbed) {
        $innerHostPath = $innerEmbed->hostPath;

        if ($innerHostPath) {
            $sourceHostId = $innerHostPath->id;
            $newHostId    = $idMap[$sourceHostId] ?? null;
            $newHostPath  = $pathMap[$sourceHostId] ?? null;

            if (!$newHostId) continue;

            $this->copyBlueprintRecursive(
                blueprint:       $innerEmbed->embeddedBlueprint,
                hostBlueprint:   $hostBlueprint,
                baseParentId:    $newHostId,
                baseParentPath:  $newHostPath,
                rootEmbed:       $rootEmbed,
                depth:           $depth + 1  // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≥–ª—É–±–∏–Ω—É
            );
        } else {
            // –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –≤ –∫–æ—Ä–µ–Ω—å –≤–Ω—É—Ç—Ä–∏ blueprint
            $this->copyBlueprintRecursive(
                blueprint:       $innerEmbed->embeddedBlueprint,
                hostBlueprint:   $hostBlueprint,
                baseParentId:    $baseParentId,
                baseParentPath:  $baseParentPath,
                rootEmbed:       $rootEmbed,
                depth:           $depth + 1
            );
        }
    }
}
```

**Acceptance Criteria:**

-   ‚úÖ –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ paths –∫–æ–ø–∏—Ä—É—é—Ç—Å—è
-   ‚úÖ –í–ª–æ–∂–µ–Ω–Ω—ã–µ embeds —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ
-   ‚úÖ full_path –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
-   ‚úÖ MAX_EMBED_DEPTH –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è
-   ‚úÖ blueprint_embed_id = rootEmbed.id –¥–ª—è –í–°–ï–• –∫–æ–ø–∏–π

**–¢—Ä—É–¥–æ—ë–º–∫–æ—Å—Ç—å:** 8 —á–∞—Å–æ–≤

---

## 5. Definition of Done

### 5.1. DoD –¥–ª—è –∑–∞–¥–∞—á–∏

-   [ ] –ö–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
-   [ ] Unit-—Ç–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç
-   [ ] PHPDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã
-   [ ] PSR-12 —Å–æ–±–ª—é–¥—ë–Ω (Laravel Pint)
-   [ ] Code review –ø—Ä–æ–π–¥–µ–Ω
-   [ ] –ù–µ—Ç linter errors
-   [ ] –ù–µ—Ç SQL N+1 queries (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Debugbar)

### 5.2. DoD –¥–ª—è Sprint

-   [ ] –í—Å–µ –∑–∞–¥–∞—á–∏ Sprint –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
-   [ ] Feature-—Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
-   [ ] Integration-—Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)
-   [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
-   [ ] `php artisan test` –∑–µ–ª—ë–Ω—ã–π
-   [ ] `composer scribe:gen` —É—Å–ø–µ—à–µ–Ω
-   [ ] Demo –Ω–∞ staging

### 5.3. DoD –¥–ª—è Milestone

-   [ ] –í—Å–µ Sprint Milestone –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
-   [ ] Performance-—Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)
-   [ ] Scribe-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞
-   [ ] README –æ–±–Ω–æ–≤–ª—ë–Ω
-   [ ] Rollback-—Å—Ç—Ä–∞—Ç–µ–≥–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞
-   [ ] Production deployment —É—Å–ø–µ—à–µ–Ω

---

## 6. –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

| –†–∏—Å–∫                                                 | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ     | –ú–∏—Ç–∏–≥–∞—Ü–∏—è                           |
| ---------------------------------------------------- | ----------- | ----------- | ----------------------------------- |
| **–ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–µ–∫–∞ –ø—Ä–∏ –≥–ª—É–±–æ–∫–æ–π —Ä–µ–∫—É—Ä—Å–∏–∏**         | –°—Ä–µ–¥–Ω—è—è     | –í—ã—Å–æ–∫–æ–µ     | MAX_EMBED_DEPTH = 5 + unit-—Ç–µ—Å—Ç     |
| **SQL timeout –ø—Ä–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±–æ–ª—å—à–∏—Ö blueprint** | –°—Ä–µ–¥–Ω—è—è     | –í—ã—Å–æ–∫–æ–µ     | DB::transaction timeout 120s        |
| **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã full_path –Ω–µ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è**             | –ù–∏–∑–∫–∞—è      | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | PRE-CHECK –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, 100% coverage |
| **N+1 queries –ø—Ä–∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏**                       | –í—ã—Å–æ–∫–∞—è     | –°—Ä–µ–¥–Ω–µ–µ     | Eager loading, –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ       |
| **–ö–∞—Å–∫–∞–¥–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –∑–∞—Ü–∏–∫–ª–∏–≤–∞—é—Ç—Å—è**                  | –ù–∏–∑–∫–∞—è      | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | processedBlueprints + unit-—Ç–µ—Å—Ç     |
| **Concurrent modification (–¥–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)**       | –°—Ä–µ–¥–Ω—è—è     | –°—Ä–µ–¥–Ω–µ–µ     | Optimistic locking (updated_at)     |
| **–ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å—Ç—Ä–æ–∏—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–æ**              | –°—Ä–µ–¥–Ω—è—è     | –ù–∏–∑–∫–æ–µ      | Closure Table (Could Have)          |

---

## 7. –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### 7.1. –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π stupidCMS
git checkout -b feature/blueprint-system

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ!)
php artisan migrate

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–¥–µ—Ä—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
php artisan db:seed --class=BlueprintSeeder
```

### 7.2. Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
php artisan make:migration create_blueprints_table

# –°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å —Å –º–∏–≥—Ä–∞—Ü–∏–µ–π
php artisan make:model Blueprint -m

# –°–æ–∑–¥–∞—Ç—å —Ñ–∞–±—Ä–∏–∫—É
php artisan make:factory BlueprintFactory

# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç
php artisan make:test BlueprintStructureServiceTest --unit

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
php artisan test --filter BlueprintStructureServiceTest

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PSR-12
./vendor/bin/pint

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç–∏–∫—É (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω phpstan)
./vendor/bin/phpstan analyse app/Domain/Blueprints

# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
composer scribe:gen
```

### 7.3. Debugging

```bash
# –í–∫–ª—é—á–∏—Ç—å query log
DB::enableQueryLog();
// –≤–∞—à –∫–æ–¥
dd(DB::getQueryLog());

# –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Telescope
php artisan telescope:install

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤
EXPLAIN SELECT * FROM doc_values WHERE path_id = 100;
```

### 7.4. –ú–∏–≥—Ä–∞—Ü–∏—è –∏ rollback

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
php artisan migrate

# –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∞—Ç—á
php artisan migrate:rollback

# –û—Ç–∫–∞—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é
php artisan migrate:rollback --step=1

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ë–î
php artisan migrate:fresh --seed
```

---

## 8. –ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### 8.1. –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

```
Materialization.duration     < 5 —Å–µ–∫—É–Ω–¥  (–¥–ª—è blueprint —Å 100 paths)
EntryIndexing.duration       < 500 ms    (–¥–ª—è entry —Å 50 –ø–æ–ª—è–º–∏)
wherePath.query.duration     < 100 ms    (JOIN –Ω–∞ doc_values)
CyclicCheck.duration         < 50 ms     (BFS –Ω–∞ –≥—Ä–∞—Ñ–µ 100 blueprint)
PRE-CHECK.duration           < 200 ms    (—Å–±–æ—Ä 500 paths)
```

### 8.2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```php
// –í BlueprintStructureService::materializeEmbeddedBlueprint()
$start = microtime(true);
// ... –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è ...
$duration = microtime(true) - $start;

Log::info('Blueprint materialized', [
    'blueprint_id' => $hostBlueprint->id,
    'embed_id' => $embed->id,
    'duration_ms' => $duration * 1000,
    'paths_copied' => $pathsCopiedCount,
]);
```

---

## 9. –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **Week 1:** –ù–∞—á–∞—Ç—å Sprint 1 (–ë–î –∏ –º–æ–¥–µ–ª–∏)
2. **Daily standups:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
3. **Code reviews:** –ö–∞–∂–¥—ã–π PR –ø–µ—Ä–µ–¥ –º–µ—Ä–∂–µ–º
4. **Demo –Ω–∞ staging:** –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ Sprint
5. **–†–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–∞:** –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ Milestone

---

**–î–æ–∫—É–º–µ–Ω—Ç –≥–æ—Ç–æ–≤ –∫ –Ω–∞—á–∞–ª—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –£–¥–∞—á–∏! üöÄ**
